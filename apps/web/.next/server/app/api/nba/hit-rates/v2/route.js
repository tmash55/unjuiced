/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/nba/hit-rates/v2/route";
exports.ids = ["app/api/nba/hit-rates/v2/route"];
exports.modules = {

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&page=%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts&appDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&page=%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts&appDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/../../node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/../../node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/../../node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/../../node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/../../node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/../../node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/../../node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/../../node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/../../node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/../../node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/../../node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/../../node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _Users_drewmaschoff_dev_unjuiced_apps_web_app_api_nba_hit_rates_v2_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/nba/hit-rates/v2/route.ts */ \"(rsc)/./app/api/nba/hit-rates/v2/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/nba/hit-rates/v2/route\",\n        pathname: \"/api/nba/hit-rates/v2\",\n        filename: \"route\",\n        bundlePath: \"app/api/nba/hit-rates/v2/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"/Users/drewmaschoff/dev/unjuiced/apps/web/app/api/nba/hit-rates/v2/route.ts\",\n    nextConfigOutput,\n    userland: _Users_drewmaschoff_dev_unjuiced_apps_web_app_api_nba_hit_rates_v2_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/nba/hit-rates/v2/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGbmJhJTJGaGl0LXJhdGVzJTJGdjIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm5iYSUyRmhpdC1yYXRlcyUyRnYyJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbmJhJTJGaGl0LXJhdGVzJTJGdjIlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZkcmV3bWFzY2hvZmYlMkZkZXYlMkZ1bmp1aWNlZCUyRmFwcHMlMkZ3ZWIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGZHJld21hc2Nob2ZmJTJGZGV2JTJGdW5qdWljZWQlMkZhcHBzJTJGd2ViJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ3NDO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztB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Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2RyZXdtYXNjaG9mZi9kZXYvdW5qdWljZWQvYXBwcy93ZWIvYXBwL2FwaS9uYmEvaGl0LXJhdGVzL3YyL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9uYmEvaGl0LXJhdGVzL3YyL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbmJhL2hpdC1yYXRlcy92MlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbmJhL2hpdC1yYXRlcy92Mi9yb3V0ZVwiXG4gICAgfSxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJycsXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvZHJld21hc2Nob2ZmL2Rldi91bmp1aWNlZC9hcHBzL3dlYi9hcHAvYXBpL25iYS9oaXQtcmF0ZXMvdjIvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgdmFyIF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbDtcbiAgICBsZXQgc3JjUGFnZSA9IFwiL2FwaS9uYmEvaGl0LXJhdGVzL3YyL3JvdXRlXCI7XG4gICAgLy8gdHVyYm9wYWNrIGRvZXNuJ3Qgbm9ybWFsaXplIGAvaW5kZXhgIGluIHRoZSBwYWdlIG5hbWVcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIHRvIHByb2Nlc3MgZHluYW1pYyByb3V0ZXMgcHJvcGVybHlcbiAgICAvLyBUT0RPOiBmaXggdHVyYm9wYWNrIHByb3ZpZGluZyBkaWZmZXJpbmcgdmFsdWUgZnJvbSB3ZWJwYWNrXG4gICAgaWYgKHByb2Nlc3MuZW52LlRVUkJPUEFDSykge1xuICAgICAgICBzcmNQYWdlID0gc3JjUGFnZS5yZXBsYWNlKC9cXC9pbmRleCQvLCAnJykgfHwgJy8nO1xuICAgIH0gZWxzZSBpZiAoc3JjUGFnZSA9PT0gJy9pbmRleCcpIHtcbiAgICAgICAgLy8gd2UgYWx3YXlzIG5vcm1hbGl6ZSAvaW5kZXggc3BlY2lmaWNhbGx5XG4gICAgICAgIHNyY1BhZ2UgPSAnLyc7XG4gICAgfVxuICAgIGNvbnN0IG11bHRpWm9uZURyYWZ0TW9kZSA9IHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREU7XG4gICAgY29uc3QgcHJlcGFyZVJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLnByZXBhcmUocmVxLCByZXMsIHtcbiAgICAgICAgc3JjUGFnZSxcbiAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlXG4gICAgfSk7XG4gICAgaWYgKCFwcmVwYXJlUmVzdWx0KSB7XG4gICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO1xuICAgICAgICByZXMuZW5kKCdCYWQgUmVxdWVzdCcpO1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCB7IGJ1aWxkSWQsIHBhcmFtcywgbmV4dENvbmZpZywgaXNEcmFmdE1vZGUsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0LCBpc09uRGVtYW5kUmV2YWxpZGF0ZSwgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsIHJlc29sdmVkUGF0aG5hbWUgfSA9IHByZXBhcmVSZXN1bHQ7XG4gICAgY29uc3Qgbm9ybWFsaXplZFNyY1BhZ2UgPSBub3JtYWxpemVBcHBQYXRoKHNyY1BhZ2UpO1xuICAgIGxldCBpc0lzciA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV0gfHwgcHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW3Jlc29sdmVkUGF0aG5hbWVdKTtcbiAgICBpZiAoaXNJc3IgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNvbnN0IGlzUHJlcmVuZGVyZWQgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgICAgIGNvbnN0IHByZXJlbmRlckluZm8gPSBwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXTtcbiAgICAgICAgaWYgKHByZXJlbmRlckluZm8pIHtcbiAgICAgICAgICAgIGlmIChwcmVyZW5kZXJJbmZvLmZhbGxiYWNrID09PSBmYWxzZSAmJiAhaXNQcmVyZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb0ZhbGxiYWNrRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgY2FjaGVLZXkgPSBudWxsO1xuICAgIGlmIChpc0lzciAmJiAhcm91dGVNb2R1bGUuaXNEZXYgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNhY2hlS2V5ID0gcmVzb2x2ZWRQYXRobmFtZTtcbiAgICAgICAgLy8gZW5zdXJlIC9pbmRleCBhbmQgLyBpcyBub3JtYWxpemVkIHRvIG9uZSBrZXlcbiAgICAgICAgY2FjaGVLZXkgPSBjYWNoZUtleSA9PT0gJy9pbmRleCcgPyAnLycgOiBjYWNoZUtleTtcbiAgICB9XG4gICAgY29uc3Qgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UgPSAvLyBJZiB3ZSdyZSBpbiBkZXZlbG9wbWVudCwgd2UgYWx3YXlzIHN1cHBvcnQgZHluYW1pYyBIVE1MXG4gICAgcm91dGVNb2R1bGUuaXNEZXYgPT09IHRydWUgfHwgLy8gSWYgdGhpcyBpcyBub3QgU1NHIG9yIGRvZXMgbm90IGhhdmUgc3RhdGljIHBhdGhzLCB0aGVuIGl0IHN1cHBvcnRzXG4gICAgLy8gZHluYW1pYyBIVE1MLlxuICAgICFpc0lzcjtcbiAgICAvLyBUaGlzIGlzIGEgcmV2YWxpZGF0aW9uIHJlcXVlc3QgaWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljXG4gICAgLy8gcGFnZSBhbmQgaXQgaXMgbm90IGJlaW5nIHJlc3VtZWQgZnJvbSBhIHBvc3Rwb25lZCByZW5kZXIgYW5kXG4gICAgLy8gaXQgaXMgbm90IGEgZHluYW1pYyBSU0MgcmVxdWVzdCB0aGVuIGl0IGlzIGEgcmV2YWxpZGF0aW9uXG4gICAgLy8gcmVxdWVzdC5cbiAgICBjb25zdCBpc1JldmFsaWRhdGUgPSBpc0lzciAmJiAhc3VwcG9ydHNEeW5hbWljUmVzcG9uc2U7XG4gICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIoKTtcbiAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgIHJlbmRlck9wdHM6IHtcbiAgICAgICAgICAgIGV4cGVyaW1lbnRhbDoge1xuICAgICAgICAgICAgICAgIGNhY2hlQ29tcG9uZW50czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5jYWNoZUNvbXBvbmVudHMpLFxuICAgICAgICAgICAgICAgIGF1dGhJbnRlcnJ1cHRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmF1dGhJbnRlcnJ1cHRzKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlLFxuICAgICAgICAgICAgaW5jcmVtZW50YWxDYWNoZTogZ2V0UmVxdWVzdE1ldGEocmVxLCAnaW5jcmVtZW50YWxDYWNoZScpLFxuICAgICAgICAgICAgY2FjaGVMaWZlUHJvZmlsZXM6IChfbmV4dENvbmZpZ19leHBlcmltZW50YWwgPSBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbC5jYWNoZUxpZmUsXG4gICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWwsXG4gICAgICAgICAgICBvbkNsb3NlOiAoY2IpPT57XG4gICAgICAgICAgICAgICAgcmVzLm9uKCdjbG9zZScsIGNiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkFmdGVyVGFza0Vycm9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBvbkluc3RydW1lbnRhdGlvblJlcXVlc3RFcnJvcjogKGVycm9yLCBfcmVxdWVzdCwgZXJyb3JDb250ZXh0KT0+cm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnJvciwgZXJyb3JDb250ZXh0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KVxuICAgICAgICB9LFxuICAgICAgICBzaGFyZWRDb250ZXh0OiB7XG4gICAgICAgICAgICBidWlsZElkXG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IG5vZGVOZXh0UmVxID0gbmV3IE5vZGVOZXh0UmVxdWVzdChyZXEpO1xuICAgIGNvbnN0IG5vZGVOZXh0UmVzID0gbmV3IE5vZGVOZXh0UmVzcG9uc2UocmVzKTtcbiAgICBjb25zdCBuZXh0UmVxID0gTmV4dFJlcXVlc3RBZGFwdGVyLmZyb21Ob2RlTmV4dFJlcXVlc3Qobm9kZU5leHRSZXEsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UocmVzKSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaW52b2tlUm91dGVNb2R1bGUgPSBhc3luYyAoc3Bhbik9PntcbiAgICAgICAgICAgIHJldHVybiByb3V0ZU1vZHVsZS5oYW5kbGUobmV4dFJlcSwgY29udGV4dCkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBoYW5kbGVSZXNwb25zZSA9IGFzeW5jIChjdXJyZW50U3Bhbik9PntcbiAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlR2VuZXJhdG9yID0gYXN5bmMgKHsgcHJldmlvdXNDYWNoZUVudHJ5IH0pPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzT25EZW1hbmRSZXZhbGlkYXRlICYmIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkICYmICFwcmV2aW91c0NhY2hlRW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb24tZGVtYW5kIHJldmFsaWRhdGUgYWx3YXlzIHNldHMgdGhpcyBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgJ1JFVkFMSURBVEVEJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZW5kKCdUaGlzIHBhZ2UgY291bGQgbm90IGJlIGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGN1cnJlbnRTcGFuKTtcbiAgICAgICAgICAgICAgICAgICAgcmVxLmZldGNoTWV0cmljcyA9IGNvbnRleHQucmVuZGVyT3B0cy5mZXRjaE1ldHJpY3M7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nV2FpdFVudGlsID0gY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWw7XG4gICAgICAgICAgICAgICAgICAgIC8vIEF0dGVtcHQgdXNpbmcgcHJvdmlkZWQgd2FpdFVudGlsIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIG5vdCB3ZSBmYWxsYmFjayB0byBzZW5kUmVzcG9uc2UncyBoYW5kbGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1dhaXRVbnRpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC53YWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgud2FpdFVudGlsKHBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdXYWl0VW50aWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVUYWdzID0gY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFRhZ3M7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpYyByZXNwb25zZSwgd2UgY2FuIGNhY2hlIGl0IHNvIGxvbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gYXMgaXQncyBub3QgZWRnZS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSXNyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29weSB0aGUgaGVhZGVycyBmcm9tIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKHJlc3BvbnNlLmhlYWRlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlVGFncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbTkVYVF9DQUNIRV9UQUdTX0hFQURFUl0gPSBjYWNoZVRhZ3M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddICYmIGJsb2IudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gYmxvYi50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV2YWxpZGF0ZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPj0gSU5GSU5JVEVfQ0FDSEUgPyBmYWxzZSA6IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwaXJlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmUgPj0gSU5GSU5JVEVfQ0FDSEUgPyB1bmRlZmluZWQgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBjYWNoZSBlbnRyeSBmb3IgdGhlIHJlc3BvbnNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogQnVmZmVyLmZyb20oYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVFbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgcmVzcG9uc2Ugd2l0aG91dCBjYWNoaW5nIGlmIG5vdCBJU1JcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIHJlc3BvbnNlLCBjb250ZXh0LnJlbmRlck9wdHMucGVuZGluZ1dhaXRVbnRpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgYmFja2dyb3VuZCByZXZhbGlkYXRlIHdlIG5lZWQgdG8gcmVwb3J0XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSByZXF1ZXN0IGVycm9yIGhlcmUgYXMgaXQgd29uJ3QgYmUgYnViYmxlZFxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNDYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiBwcmV2aW91c0NhY2hlRW50cnkuaXNTdGFsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVQYXRoOiBzcmNQYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSBhd2FpdCByb3V0ZU1vZHVsZS5oYW5kbGVSZXNwb25zZSh7XG4gICAgICAgICAgICAgICAgcmVxLFxuICAgICAgICAgICAgICAgIG5leHRDb25maWcsXG4gICAgICAgICAgICAgICAgY2FjaGVLZXksXG4gICAgICAgICAgICAgICAgcm91dGVLaW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICAgICAgICAgIGlzRmFsbGJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICAgICAgICAgIGlzUm91dGVQUFJFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlT25seUdlbmVyYXRlZCxcbiAgICAgICAgICAgICAgICByZXNwb25zZUdlbmVyYXRvcixcbiAgICAgICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gd2UgZG9uJ3QgY3JlYXRlIGEgY2FjaGVFbnRyeSBmb3IgSVNSXG4gICAgICAgICAgICBpZiAoIWlzSXNyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGNhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZS5raW5kKSAhPT0gQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSkge1xuICAgICAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTE7XG4gICAgICAgICAgICAgICAgdGhyb3cgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ldyBFcnJvcihgSW52YXJpYW50OiBhcHAtcm91dGUgcmVjZWl2ZWQgaW52YWxpZCBjYWNoZSBlbnRyeSAke2NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZTEgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUxLmtpbmR9YCksIFwiX19ORVhUX0VSUk9SX0NPREVcIiwge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJFNzAxXCIsXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgaXNPbkRlbWFuZFJldmFsaWRhdGUgPyAnUkVWQUxJREFURUQnIDogY2FjaGVFbnRyeS5pc01pc3MgPyAnTUlTUycgOiBjYWNoZUVudHJ5LmlzU3RhbGUgPyAnU1RBTEUnIDogJ0hJVCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRHJhZnQgbW9kZSBzaG91bGQgbmV2ZXIgYmUgY2FjaGVkXG4gICAgICAgICAgICBpZiAoaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ3ByaXZhdGUsIG5vLWNhY2hlLCBuby1zdG9yZSwgbWF4LWFnZT0wLCBtdXN0LXJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBmcm9tTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMoY2FjaGVFbnRyeS52YWx1ZS5oZWFkZXJzKTtcbiAgICAgICAgICAgIGlmICghKGdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNJc3IpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5kZWxldGUoTkVYVF9DQUNIRV9UQUdTX0hFQURFUik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiBjYWNoZSBjb250cm9sIGlzIGFscmVhZHkgc2V0IG9uIHRoZSByZXNwb25zZSB3ZSBkb24ndFxuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgaXQgdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9taXplIGl0IHZpYSBuZXh0LmNvbmZpZ1xuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuY2FjaGVDb250cm9sICYmICFyZXMuZ2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJykgJiYgIWhlYWRlcnMuZ2V0KCdDYWNoZS1Db250cm9sJykpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNldCgnQ2FjaGUtQ29udHJvbCcsIGdldENhY2hlQ29udHJvbEhlYWRlcihjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgbmV3IFJlc3BvbnNlKGNhY2hlRW50cnkudmFsdWUuYm9keSwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBjYWNoZUVudHJ5LnZhbHVlLnN0YXR1cyB8fCAyMDBcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaGFuZGxlUmVzcG9uc2UoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaGFuZGxlUmVzcG9uc2UpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBOb0ZhbGxiYWNrRXJyb3IpKSB7XG4gICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdBcHAgUm91dGVyJyxcbiAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IG5vcm1hbGl6ZWRTcmNQYWdlLFxuICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZXRocm93IHNvIHRoYXQgd2UgY2FuIGhhbmRsZSBzZXJ2aW5nIGVycm9yIHBhZ2VcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBkdXJpbmcgc3RhdGljIGdlbmVyYXRpb24sIHRocm93IHRoZSBlcnJvciBhZ2Fpbi5cbiAgICAgICAgaWYgKGlzSXNyKSB0aHJvdyBlcnI7XG4gICAgICAgIC8vIE90aGVyd2lzZSwgc2VuZCBhIDUwMCByZXNwb25zZS5cbiAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgbmV3IFJlc3BvbnNlKG51bGwsIHtcbiAgICAgICAgICAgIHN0YXR1czogNTAwXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&page=%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts&appDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%2C%5B%7B%22id%22%3A%22400d3b945fb780941a4207c8e8c9572ddce7d46e6b%22%2C%22exportedName%22%3A%22OPTIONS%22%2C%22filename%22%3A%22app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%7D%2C%7B%22id%22%3A%2240b5713a027c49a623c59a9c238b7b88df5e924159%22%2C%22exportedName%22%3A%22GET%22%2C%22filename%22%3A%22app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%7D%5D%5D%5D&__client_imported__=!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%2C%5B%7B%22id%22%3A%22400d3b945fb780941a4207c8e8c9572ddce7d46e6b%22%2C%22exportedName%22%3A%22OPTIONS%22%2C%22filename%22%3A%22app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%7D%2C%7B%22id%22%3A%2240b5713a027c49a623c59a9c238b7b88df5e924159%22%2C%22exportedName%22%3A%22GET%22%2C%22filename%22%3A%22app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%7D%5D%5D%5D&__client_imported__=! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"400d3b945fb780941a4207c8e8c9572ddce7d46e6b\": () => (/* reexport safe */ _Users_drewmaschoff_dev_unjuiced_apps_web_app_api_nba_hit_rates_v2_route_ts__WEBPACK_IMPORTED_MODULE_0__.OPTIONS),\n/* harmony export */   \"40b5713a027c49a623c59a9c238b7b88df5e924159\": () => (/* reexport safe */ _Users_drewmaschoff_dev_unjuiced_apps_web_app_api_nba_hit_rates_v2_route_ts__WEBPACK_IMPORTED_MODULE_0__.GET)\n/* harmony export */ });\n/* harmony import */ var _Users_drewmaschoff_dev_unjuiced_apps_web_app_api_nba_hit_rates_v2_route_ts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app/api/nba/hit-rates/v2/route.ts */ \"(rsc)/./app/api/nba/hit-rates/v2/route.ts\");\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1mbGlnaHQtYWN0aW9uLWVudHJ5LWxvYWRlci5qcz9hY3Rpb25zPSU1QiU1QiUyMiUyRlVzZXJzJTJGZHJld21hc2Nob2ZmJTJGZGV2JTJGdW5qdWljZWQlMkZhcHBzJTJGd2ViJTJGYXBwJTJGYXBpJTJGbmJhJTJGaGl0LXJhdGVzJTJGdjIlMkZyb3V0ZS50cyUyMiUyQyU1QiU3QiUyMmlkJTIyJTNBJTIyNDAwZDNiOTQ1ZmI3ODA5NDFhNDIwN2M4ZThjOTU3MmRkY2U3ZDQ2ZTZiJTIyJTJDJTIyZXhwb3J0ZWROYW1lJTIyJTNBJTIyT1BUSU9OUyUyMiUyQyUyMmZpbGVuYW1lJTIyJTNBJTIyYXBwJTJGYXBpJTJGbmJhJTJGaGl0LXJhdGVzJTJGdjIlMkZyb3V0ZS50cyUyMiU3RCUyQyU3QiUyMmlkJTIyJTNBJTIyNDBiNTcxM2EwMjdjNDlhNjIzYzU5YTljMjM4YjdiODhkZjVlOTI0MTU5JTIyJTJDJTIyZXhwb3J0ZWROYW1lJTIyJTNBJTIyR0VUJTIyJTJDJTIyZmlsZW5hbWUlMjIlM0ElMjJhcHAlMkZhcGklMkZuYmElMkZoaXQtcmF0ZXMlMkZ2MiUyRnJvdXRlLnRzJTIyJTdEJTVEJTVEJTVEJl9fY2xpZW50X2ltcG9ydGVkX189ISIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ3FKO0FBQ0oiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCB7IE9QVElPTlMgYXMgXCI0MDBkM2I5NDVmYjc4MDk0MWE0MjA3YzhlOGM5NTcyZGRjZTdkNDZlNmJcIiB9IGZyb20gXCIvVXNlcnMvZHJld21hc2Nob2ZmL2Rldi91bmp1aWNlZC9hcHBzL3dlYi9hcHAvYXBpL25iYS9oaXQtcmF0ZXMvdjIvcm91dGUudHNcIlxuZXhwb3J0IHsgR0VUIGFzIFwiNDBiNTcxM2EwMjdjNDlhNjIzYzU5YTljMjM4YjdiODhkZjVlOTI0MTU5XCIgfSBmcm9tIFwiL1VzZXJzL2RyZXdtYXNjaG9mZi9kZXYvdW5qdWljZWQvYXBwcy93ZWIvYXBwL2FwaS9uYmEvaGl0LXJhdGVzL3YyL3JvdXRlLnRzXCJcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%2C%5B%7B%22id%22%3A%22400d3b945fb780941a4207c8e8c9572ddce7d46e6b%22%2C%22exportedName%22%3A%22OPTIONS%22%2C%22filename%22%3A%22app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%7D%2C%7B%22id%22%3A%2240b5713a027c49a623c59a9c238b7b88df5e924159%22%2C%22exportedName%22%3A%22GET%22%2C%22filename%22%3A%22app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts%22%7D%5D%5D%5D&__client_imported__=!\n");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./app/api/nba/hit-rates/v2/route.ts":
/*!*******************************************!*\
  !*** ./app/api/nba/hit-rates/v2/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/../../node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(rsc)/../../node_modules/zod/v3/types.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/redis */ \"(rsc)/./lib/redis.ts\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"400d3b945fb780941a4207c8e8c9572ddce7d46e6b\":\"OPTIONS\",\"40b5713a027c49a623c59a9c238b7b88df5e924159\":\"GET\"} */ \n\n\n\n\n\n/**\n * Hit Rates API v2 - OPTIMIZED VERSION\n * \n * Uses the new `get_nba_hit_rate_profiles_fast_v3` RPC which:\n * 1. Has NO JOINs (all data denormalized in the table)\n * 2. Pre-computed DvP ranks (no separate matchup call needed)\n * 3. Filters by has_live_odds for actionable profiles first\n * 4. No COUNT(*) query overhead\n * 5. Includes sel_key for Redis best odds lookup\n * \n * Also merges live best odds from Redis for \"card-ready\" data.\n * \n * Expected performance: <500ms vs 8-12s before\n */ // Cache configuration\nconst CACHE_TTL_SECONDS = 60; // 1 minute cache\nconst CACHE_KEY_PREFIX = \"hitrates:nba:v4\"; // Incremented for v3 RPC + best odds integration\nfunction resolveAllowedOrigin(origin) {\n    if (!origin) return null;\n    const isLocalhost = /^http:\\/\\/localhost:\\d+$/.test(origin) || /^http:\\/\\/127\\.0\\.0\\.1:\\d+$/.test(origin);\n    if (isLocalhost) return origin;\n    if (origin === \"https://app.unjuiced.bet\") return origin;\n    if (origin === \"https://www.unjuiced.bet\") return origin;\n    if (origin === \"https://unjuiced.bet\") return origin;\n    return null;\n}\nfunction getCorsHeaders(origin) {\n    const allowedOrigin = resolveAllowedOrigin(origin);\n    return {\n        \"Access-Control-Allow-Origin\": allowedOrigin ?? \"null\",\n        \"Access-Control-Allow-Methods\": \"GET, OPTIONS\",\n        \"Access-Control-Allow-Headers\": \"Authorization, Content-Type, Cache-Control, Pragma\",\n        \"Access-Control-Allow-Credentials\": \"true\",\n        \"Access-Control-Max-Age\": \"86400\",\n        Vary: \"Origin\"\n    };\n}\nfunction jsonWithHeaders(body, status, origin, extraHeaders) {\n    return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json(body, {\n        status,\n        headers: {\n            ...getCorsHeaders(origin),\n            ...extraHeaders ?? {}\n        }\n    });\n}\n// =============================================================================\n// REDIS BEST ODDS HELPERS\n// =============================================================================\n/**\n * Batch fetch best odds from Redis for all rows with valid keys\n */ async function fetchBestOddsForRows(rows) {\n    const result = new Map();\n    // Filter rows that have all required fields for Redis lookup\n    const validRows = rows.filter((r)=>r.event_id && r.market && r.sel_key);\n    if (validRows.length === 0) {\n        return result;\n    }\n    // Build Redis keys\n    const keys = validRows.map((r)=>`bestodds:nba:${r.event_id}:${r.market}:${r.sel_key}`);\n    try {\n        // Batch fetch all keys in one round trip\n        const values = await _lib_redis__WEBPACK_IMPORTED_MODULE_4__.redis.mget(...keys);\n        // Map results back to composite keys for easy lookup\n        validRows.forEach((row, i)=>{\n            const compositeKey = `${row.event_id}:${row.market}:${row.sel_key}`;\n            const value = values[i];\n            // Handle both string and object responses from Redis\n            if (value) {\n                if (typeof value === 'string') {\n                    try {\n                        result.set(compositeKey, JSON.parse(value));\n                    } catch  {\n                        result.set(compositeKey, null);\n                    }\n                } else {\n                    result.set(compositeKey, value);\n                }\n            } else {\n                result.set(compositeKey, null);\n            }\n        });\n    } catch (e) {\n        console.error(\"[Hit Rates v2] Redis best odds fetch error:\", e);\n    // Return empty map on error - gracefully degrade\n    }\n    return result;\n}\n// Valid sort fields for hit rates\nconst VALID_SORT_FIELDS = [\n    \"line\",\n    \"l5Avg\",\n    \"l10Avg\",\n    \"seasonAvg\",\n    \"streak\",\n    \"l5Pct\",\n    \"l10Pct\",\n    \"l20Pct\",\n    \"seasonPct\",\n    \"h2hPct\",\n    \"matchupRank\"\n];\nconst QuerySchema = zod__WEBPACK_IMPORTED_MODULE_5__.object({\n    date: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional().refine((value)=>!value || /^\\d{4}-\\d{2}-\\d{2}$/.test(value), \"date must be YYYY-MM-DD\"),\n    market: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional(),\n    minHitRate: zod__WEBPACK_IMPORTED_MODULE_5__.coerce.number().min(0).max(100).optional(),\n    limit: zod__WEBPACK_IMPORTED_MODULE_5__.coerce.number().min(1).max(5000).optional(),\n    offset: zod__WEBPACK_IMPORTED_MODULE_5__.coerce.number().min(0).optional(),\n    search: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional(),\n    playerId: zod__WEBPACK_IMPORTED_MODULE_5__.coerce.number().int().positive().optional(),\n    sort: zod__WEBPACK_IMPORTED_MODULE_5__[\"enum\"](VALID_SORT_FIELDS).optional(),\n    sortDir: zod__WEBPACK_IMPORTED_MODULE_5__[\"enum\"]([\n        \"asc\",\n        \"desc\"\n    ]).optional(),\n    skipCache: zod__WEBPACK_IMPORTED_MODULE_5__.coerce.boolean().optional(),\n    hasOdds: zod__WEBPACK_IMPORTED_MODULE_5__.coerce.boolean().optional()\n});\nconst DEFAULT_LIMIT = 500; // Fetch more for client-side sorting\n// No default market - when null, fetch ALL markets for flexible client-side filtering\n// Get current ET date\nfunction getETDate(offsetDays = 0) {\n    const now = new Date();\n    now.setDate(now.getDate() + offsetDays);\n    return new Intl.DateTimeFormat('en-CA', {\n        timeZone: 'America/New_York',\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n    }).format(now);\n}\n// Generate cache key\nfunction getCacheKey(dates, market, hasOdds) {\n    const dateKey = dates.sort().join(\"_\");\n    const marketKey = market || \"all\";\n    const oddsKey = hasOdds ? \"odds\" : \"all\";\n    return `${CACHE_KEY_PREFIX}:${dateKey}:${marketKey}:${oddsKey}`;\n}\n// Transform RPC response to frontend format\nfunction transformProfile(row, bestOdds) {\n    // Determine matchup quality from dvp_rank\n    let matchupQuality = null;\n    if (row.dvp_rank) {\n        if (row.dvp_rank <= 10) matchupQuality = \"unfavorable\"; // Tough defense\n        else if (row.dvp_rank >= 21) matchupQuality = \"favorable\"; // Weak defense\n        else matchupQuality = \"neutral\";\n    }\n    return {\n        id: row.id,\n        player_id: row.player_id,\n        player_name: row.player_name,\n        team_id: row.team_id,\n        market: row.market,\n        line: row.line,\n        opponent_team_id: row.opponent_team_id,\n        game_id: row.game_id,\n        game_date: row.game_date,\n        last_5_pct: row.last_5_pct,\n        last_10_pct: row.last_10_pct,\n        last_20_pct: row.last_20_pct,\n        season_pct: row.season_pct,\n        h2h_pct: row.h2h_pct,\n        h2h_avg: row.h2h_avg,\n        h2h_games: row.h2h_games,\n        hit_streak: row.hit_streak,\n        last_5_avg: row.last_5_avg,\n        last_10_avg: row.last_10_avg,\n        last_20_avg: row.last_20_avg,\n        season_avg: row.season_avg,\n        spread: row.spread,\n        total: row.total,\n        spread_clv: row.spread_clv,\n        total_clv: row.total_clv,\n        injury_status: row.injury_status,\n        injury_notes: row.injury_notes,\n        team_name: row.team_name,\n        team_abbr: row.team_abbr,\n        opponent_team_name: row.opponent_team_name,\n        opponent_team_abbr: row.opponent_team_abbr,\n        player_position: row.player_position || row.player_depth_chart_pos,\n        jersey_number: row.jersey_number,\n        created_at: row.created_at,\n        updated_at: row.updated_at,\n        home_away: row.home_away,\n        national_broadcast: row.national_broadcast,\n        is_primetime: row.is_primetime,\n        odds_selection_id: row.odds_selection_id,\n        event_id: row.event_id,\n        is_back_to_back: row.is_back_to_back,\n        // New field from v3 RPC - needed for Redis lookup\n        sel_key: row.sel_key,\n        // Live best odds from Redis\n        best_odds: bestOdds ? {\n            book: bestOdds.best_book,\n            price: bestOdds.best_price,\n            updated_at: bestOdds.updated_at\n        } : null,\n        books: bestOdds?.book_count ?? 0,\n        // Player info (now denormalized)\n        nba_players_hr: row.player_name ? {\n            nba_player_id: row.player_id,\n            name: row.player_name,\n            position: row.player_depth_chart_pos || row.player_position,\n            depth_chart_pos: row.player_depth_chart_pos,\n            jersey_number: row.jersey_number\n        } : null,\n        // Game info (now denormalized)\n        nba_games_hr: {\n            game_date: row.game_date,\n            home_team_name: row.home_team_name,\n            away_team_name: row.away_team_name,\n            game_status: row.game_status\n        },\n        // Team colors (now denormalized - no accent_color in table yet)\n        nba_teams: row.primary_color ? {\n            primary_color: row.primary_color,\n            secondary_color: row.secondary_color,\n            accent_color: null\n        } : null,\n        // Matchup/DvP data (now pre-computed in table - no dvp_avg_allowed yet)\n        matchup: row.dvp_rank ? {\n            player_id: row.player_id,\n            market: row.market,\n            opponent_team_id: row.opponent_team_id,\n            player_position: row.player_depth_chart_pos || row.player_position,\n            matchup_rank: row.dvp_rank,\n            rank_label: row.dvp_label,\n            avg_allowed: null,\n            matchup_quality: matchupQuality\n        } : null\n    };\n}\n// Sort data client-side for flexibility\nfunction sortData(data, sort, sortDir) {\n    const multiplier = sortDir === \"asc\" ? 1 : -1;\n    const fieldMap = {\n        \"line\": \"line\",\n        \"l5Avg\": \"last_5_avg\",\n        \"l10Avg\": \"last_10_avg\",\n        \"seasonAvg\": \"season_avg\",\n        \"streak\": \"hit_streak\",\n        \"l5Pct\": \"last_5_pct\",\n        \"l10Pct\": \"last_10_pct\",\n        \"l20Pct\": \"last_20_pct\",\n        \"seasonPct\": \"season_pct\",\n        \"h2hPct\": \"h2h_pct\",\n        \"matchupRank\": \"dvp_rank\"\n    };\n    const dbField = fieldMap[sort];\n    if (!dbField) return data;\n    return [\n        ...data\n    ].sort((a, b)=>{\n        const aVal = a[dbField];\n        const bVal = b[dbField];\n        // ALWAYS push nulls to the END of the list\n        if (aVal === null && bVal === null) return 0;\n        if (aVal === null) return 1; // a goes after b\n        if (bVal === null) return -1; // b goes after a\n        return (aVal - bVal) * multiplier;\n    });\n}\n// Filter data by search/market/player\nfunction filterData(data, search, market, playerId) {\n    let result = data;\n    if (search?.trim()) {\n        const searchLower = search.toLowerCase().trim();\n        result = result.filter((row)=>row.player_name?.toLowerCase().includes(searchLower) || row.team_name?.toLowerCase().includes(searchLower) || row.team_abbr?.toLowerCase().includes(searchLower));\n    }\n    if (market) {\n        result = result.filter((row)=>row.market === market);\n    }\n    if (playerId) {\n        result = result.filter((row)=>row.player_id === playerId);\n    }\n    return result;\n}\nasync function OPTIONS(request) {\n    return new next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse(null, {\n        status: 204,\n        headers: getCorsHeaders(request.headers.get(\"origin\"))\n    });\n}\nasync function GET(request) {\n    const startTime = Date.now();\n    const origin = request.headers.get(\"origin\");\n    const url = new URL(request.url);\n    const query = QuerySchema.safeParse({\n        date: url.searchParams.get(\"date\") ?? undefined,\n        market: url.searchParams.get(\"market\") ?? undefined,\n        minHitRate: url.searchParams.get(\"minHitRate\") ?? undefined,\n        limit: url.searchParams.get(\"limit\") ?? undefined,\n        offset: url.searchParams.get(\"offset\") ?? undefined,\n        search: url.searchParams.get(\"search\") ?? undefined,\n        playerId: url.searchParams.get(\"playerId\") ?? undefined,\n        sort: url.searchParams.get(\"sort\") ?? undefined,\n        sortDir: url.searchParams.get(\"sortDir\") ?? undefined,\n        skipCache: url.searchParams.get(\"skipCache\") ?? undefined,\n        hasOdds: url.searchParams.get(\"hasOdds\") ?? undefined\n    });\n    if (!query.success) {\n        return jsonWithHeaders({\n            error: \"Invalid query params\",\n            details: query.error.flatten()\n        }, 400, origin);\n    }\n    const { date, market: rawMarket, minHitRate, limit = DEFAULT_LIMIT, offset = 0, search, playerId, sort = \"l10Pct\", sortDir = \"desc\", skipCache = false, hasOdds = true } = query.data;\n    // When no market specified, fetch ALL markets (client filters as needed)\n    const market = rawMarket || null;\n    const todayET = getETDate();\n    const tomorrowET = getETDate(1);\n    // Determine dates to fetch\n    const datesToFetch = date ? [\n        date\n    ] : [\n        todayET,\n        tomorrowET\n    ];\n    try {\n        let allData = [];\n        let cacheHit = false;\n        // Try cache first (unless search/player filter or skipCache)\n        const canUseCache = !search && !playerId && !skipCache;\n        if (canUseCache) {\n            const cacheKey = getCacheKey(datesToFetch, market, hasOdds);\n            try {\n                const cached = await _lib_redis__WEBPACK_IMPORTED_MODULE_4__.redis.get(cacheKey);\n                if (cached && cached.data) {\n                    allData = cached.data;\n                    cacheHit = true;\n                    console.log(`[Hit Rates v2] Cache HIT (${allData.length} profiles) in ${Date.now() - startTime}ms`);\n                }\n            } catch (e) {\n                console.error(\"[Hit Rates v2] Cache read error:\", e);\n            }\n        }\n        // Cache miss - fetch from Supabase using FAST RPC\n        if (!cacheHit) {\n            const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_3__.createServerSupabaseClient)();\n            const dbStartTime = Date.now();\n            // Call the new optimized RPC function (v3 includes sel_key for Redis lookup)\n            const { data, error } = await supabase.rpc(\"get_nba_hit_rate_profiles_fast_v3\", {\n                p_dates: datesToFetch,\n                p_market: market || null,\n                p_has_odds: hasOdds,\n                p_limit: market ? 500 : 3000,\n                p_offset: 0\n            });\n            if (error) {\n                console.error(\"[Hit Rates v2] RPC error:\", error.message);\n                return jsonWithHeaders({\n                    error: \"Database error\",\n                    details: error.message\n                }, 500, origin);\n            }\n            allData = data || [];\n            const dbTime = Date.now() - dbStartTime;\n            const withOddsCount = allData.filter((r)=>r.odds_selection_id).length;\n            console.log(`[Hit Rates v2] RPC fetch: ${allData.length} profiles (${withOddsCount} with odds) in ${dbTime}ms`);\n            // Cache the data\n            if (canUseCache && allData.length > 0) {\n                const cacheKey = getCacheKey(datesToFetch, market, hasOdds);\n                _lib_redis__WEBPACK_IMPORTED_MODULE_4__.redis.set(cacheKey, {\n                    data: allData,\n                    ts: Date.now()\n                }, {\n                    ex: CACHE_TTL_SECONDS\n                }).catch((e)=>console.error(\"[Hit Rates v2] Cache write error:\", e));\n            }\n        }\n        // Apply client-side filters (for search/playerId which bypass cache)\n        let filteredData = filterData(allData, search, undefined, playerId);\n        // Apply sorting\n        filteredData = sortData(filteredData, sort, sortDir);\n        // Apply min hit rate filter if specified\n        if (minHitRate) {\n            filteredData = filteredData.filter((row)=>row.last_10_pct !== null && row.last_10_pct >= minHitRate);\n        }\n        // Apply pagination\n        const paginatedData = filteredData.slice(offset, offset + limit);\n        // Fetch live best odds from Redis for paginated rows\n        const bestOddsStartTime = Date.now();\n        const bestOddsMap = await fetchBestOddsForRows(paginatedData);\n        const bestOddsTime = Date.now() - bestOddsStartTime;\n        console.log(`[Hit Rates v2] Best odds fetch: ${bestOddsMap.size} keys in ${bestOddsTime}ms`);\n        // Transform to frontend format with best odds merged\n        const transformedData = paginatedData.map((row)=>{\n            // Build composite key for lookup\n            const compositeKey = row.event_id && row.market && row.sel_key ? `${row.event_id}:${row.market}:${row.sel_key}` : null;\n            const bestOdds = compositeKey ? bestOddsMap.get(compositeKey) ?? null : null;\n            return transformProfile(row, bestOdds);\n        });\n        // Get unique dates from response\n        const availableDates = [\n            ...new Set(allData.map((r)=>r.game_date))\n        ].sort();\n        const primaryDate = availableDates[0] || todayET;\n        const responseTime = Date.now() - startTime;\n        return jsonWithHeaders({\n            data: transformedData,\n            count: filteredData.length,\n            meta: {\n                date: primaryDate,\n                availableDates,\n                market: market ?? null,\n                minHitRate: minHitRate ?? null,\n                limit,\n                offset,\n                cacheHit,\n                responseTime,\n                hasMore: filteredData.length > offset + limit\n            }\n        }, 200, origin, {\n            \"Cache-Control\": \"public, max-age=30, stale-while-revalidate=60\"\n        });\n    } catch (error) {\n        console.error(\"[Hit Rates v2] Unexpected error:\", error);\n        return jsonWithHeaders({\n            error: \"Internal server error\"\n        }, 500, origin);\n    }\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_6__.ensureServerEntryExports)([\n    OPTIONS,\n    GET\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(OPTIONS, \"400d3b945fb780941a4207c8e8c9572ddce7d46e6b\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(GET, \"40b5713a027c49a623c59a9c238b7b88df5e924159\", null);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL25iYS9oaXQtcmF0ZXMvdjIvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBRXdEO0FBQ2hDO0FBQzJDO0FBQy9CO0FBRXBDOzs7Ozs7Ozs7Ozs7O0NBYUMsR0FFRCxzQkFBc0I7QUFDdEIsTUFBTUksb0JBQW9CLElBQUksaUJBQWlCO0FBQy9DLE1BQU1DLG1CQUFtQixtQkFBbUIsaURBQWlEO0FBRTdGLFNBQVNDLHFCQUFxQkMsTUFBcUI7SUFDakQsSUFBSSxDQUFDQSxRQUFRLE9BQU87SUFFcEIsTUFBTUMsY0FBYywyQkFBMkJDLElBQUksQ0FBQ0YsV0FBVyw4QkFBOEJFLElBQUksQ0FBQ0Y7SUFDbEcsSUFBSUMsYUFBYSxPQUFPRDtJQUN4QixJQUFJQSxXQUFXLDRCQUE0QixPQUFPQTtJQUNsRCxJQUFJQSxXQUFXLDRCQUE0QixPQUFPQTtJQUNsRCxJQUFJQSxXQUFXLHdCQUF3QixPQUFPQTtJQUU5QyxPQUFPO0FBQ1Q7QUFFQSxTQUFTRyxlQUFlSCxNQUFxQjtJQUMzQyxNQUFNSSxnQkFBZ0JMLHFCQUFxQkM7SUFFM0MsT0FBTztRQUNMLCtCQUErQkksaUJBQWlCO1FBQ2hELGdDQUFnQztRQUNoQyxnQ0FBZ0M7UUFDaEMsb0NBQW9DO1FBQ3BDLDBCQUEwQjtRQUMxQkMsTUFBTTtJQUNSO0FBQ0Y7QUFFQSxTQUFTQyxnQkFDUEMsSUFBYSxFQUNiQyxNQUFjLEVBQ2RSLE1BQXFCLEVBQ3JCUyxZQUFxQztJQUVyQyxPQUFPaEIscURBQVlBLENBQUNpQixJQUFJLENBQUNILE1BQU07UUFDN0JDO1FBQ0FHLFNBQVM7WUFDUCxHQUFHUixlQUFlSCxPQUFPO1lBQ3pCLEdBQUlTLGdCQUFnQixDQUFDLENBQUM7UUFDeEI7SUFDRjtBQUNGO0FBaUJBLGdGQUFnRjtBQUNoRiwwQkFBMEI7QUFDMUIsZ0ZBQWdGO0FBRWhGOztDQUVDLEdBQ0QsZUFBZUcscUJBQ2JDLElBQXFFO0lBRXJFLE1BQU1DLFNBQVMsSUFBSUM7SUFF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QUUsR0FDOUM7WUFDSixNQUFNOEQsV0FBV3JELGVBQWVrTCxZQUFZeEMsR0FBRyxDQUFDMUksaUJBQWlCLE9BQU87WUFDeEUsT0FBT29ELGlCQUFpQnRELEtBQUt1RDtRQUMvQjtRQUVBLGlDQUFpQztRQUNqQyxNQUFNaUksaUJBQWlCO2VBQUksSUFBSUMsSUFBSTdCLFFBQVFoSyxHQUFHLENBQUMsQ0FBQ04sSUFBV0EsRUFBRTJFLFNBQVM7U0FBRyxDQUFDckMsSUFBSTtRQUM5RSxNQUFNOEosY0FBY0YsY0FBYyxDQUFDLEVBQUUsSUFBSS9CO1FBRXpDLE1BQU1rQyxlQUFlckosS0FBS0QsR0FBRyxLQUFLeUc7UUFFbEMsT0FBT3BLLGdCQUNMO1lBQ0VtSixNQUFNMEQ7WUFDTkssT0FBT1osYUFBYXRMLE1BQU07WUFDMUJtTSxNQUFNO2dCQUNKaEwsTUFBTTZLO2dCQUNORjtnQkFDQWhNLFFBQVFBLFVBQVU7Z0JBQ2xCeUIsWUFBWUEsY0FBYztnQkFDMUJLO2dCQUNBQztnQkFDQXNJO2dCQUNBOEI7Z0JBQ0FHLFNBQVNkLGFBQWF0TCxNQUFNLEdBQUc2QixTQUFTRDtZQUMxQztRQUNGLEdBQ0EsS0FDQWxELFFBQ0E7WUFBRSxpQkFBaUI7UUFBZ0Q7SUFFdkUsRUFBRSxPQUFPcUMsT0FBTztRQUNkRCxRQUFRQyxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxPQUFPL0IsZ0JBQ0w7WUFBRStCLE9BQU87UUFBd0IsR0FDakMsS0FDQXJDO0lBRUo7QUFDRjs7O0lBekxzQnNLO0lBT0FHOztBQVBBSCwwRkFBQUEsQ0FBQUE7QUFPQUcsMEZBQUFBLENBQUFBIiwic291cmNlcyI6WyIvVXNlcnMvZHJld21hc2Nob2ZmL2Rldi91bmp1aWNlZC9hcHBzL3dlYi9hcHAvYXBpL25iYS9oaXQtcmF0ZXMvdjIvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCB9IGZyb20gXCJAL2xpYi9zdXBhYmFzZS1zZXJ2ZXJcIjtcbmltcG9ydCB7IHJlZGlzIH0gZnJvbSBcIkAvbGliL3JlZGlzXCI7XG5cbi8qKlxuICogSGl0IFJhdGVzIEFQSSB2MiAtIE9QVElNSVpFRCBWRVJTSU9OXG4gKiBcbiAqIFVzZXMgdGhlIG5ldyBgZ2V0X25iYV9oaXRfcmF0ZV9wcm9maWxlc19mYXN0X3YzYCBSUEMgd2hpY2g6XG4gKiAxLiBIYXMgTk8gSk9JTnMgKGFsbCBkYXRhIGRlbm9ybWFsaXplZCBpbiB0aGUgdGFibGUpXG4gKiAyLiBQcmUtY29tcHV0ZWQgRHZQIHJhbmtzIChubyBzZXBhcmF0ZSBtYXRjaHVwIGNhbGwgbmVlZGVkKVxuICogMy4gRmlsdGVycyBieSBoYXNfbGl2ZV9vZGRzIGZvciBhY3Rpb25hYmxlIHByb2ZpbGVzIGZpcnN0XG4gKiA0LiBObyBDT1VOVCgqKSBxdWVyeSBvdmVyaGVhZFxuICogNS4gSW5jbHVkZXMgc2VsX2tleSBmb3IgUmVkaXMgYmVzdCBvZGRzIGxvb2t1cFxuICogXG4gKiBBbHNvIG1lcmdlcyBsaXZlIGJlc3Qgb2RkcyBmcm9tIFJlZGlzIGZvciBcImNhcmQtcmVhZHlcIiBkYXRhLlxuICogXG4gKiBFeHBlY3RlZCBwZXJmb3JtYW5jZTogPDUwMG1zIHZzIDgtMTJzIGJlZm9yZVxuICovXG5cbi8vIENhY2hlIGNvbmZpZ3VyYXRpb25cbmNvbnN0IENBQ0hFX1RUTF9TRUNPTkRTID0gNjA7IC8vIDEgbWludXRlIGNhY2hlXG5jb25zdCBDQUNIRV9LRVlfUFJFRklYID0gXCJoaXRyYXRlczpuYmE6djRcIjsgLy8gSW5jcmVtZW50ZWQgZm9yIHYzIFJQQyArIGJlc3Qgb2RkcyBpbnRlZ3JhdGlvblxuXG5mdW5jdGlvbiByZXNvbHZlQWxsb3dlZE9yaWdpbihvcmlnaW46IHN0cmluZyB8IG51bGwpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKCFvcmlnaW4pIHJldHVybiBudWxsO1xuXG4gIGNvbnN0IGlzTG9jYWxob3N0ID0gL15odHRwOlxcL1xcL2xvY2FsaG9zdDpcXGQrJC8udGVzdChvcmlnaW4pIHx8IC9eaHR0cDpcXC9cXC8xMjdcXC4wXFwuMFxcLjE6XFxkKyQvLnRlc3Qob3JpZ2luKTtcbiAgaWYgKGlzTG9jYWxob3N0KSByZXR1cm4gb3JpZ2luO1xuICBpZiAob3JpZ2luID09PSBcImh0dHBzOi8vYXBwLnVuanVpY2VkLmJldFwiKSByZXR1cm4gb3JpZ2luO1xuICBpZiAob3JpZ2luID09PSBcImh0dHBzOi8vd3d3LnVuanVpY2VkLmJldFwiKSByZXR1cm4gb3JpZ2luO1xuICBpZiAob3JpZ2luID09PSBcImh0dHBzOi8vdW5qdWljZWQuYmV0XCIpIHJldHVybiBvcmlnaW47XG5cbiAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIGdldENvcnNIZWFkZXJzKG9yaWdpbjogc3RyaW5nIHwgbnVsbCk6IEhlYWRlcnNJbml0IHtcbiAgY29uc3QgYWxsb3dlZE9yaWdpbiA9IHJlc29sdmVBbGxvd2VkT3JpZ2luKG9yaWdpbik7XG5cbiAgcmV0dXJuIHtcbiAgICBcIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpblwiOiBhbGxvd2VkT3JpZ2luID8/IFwibnVsbFwiLFxuICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kc1wiOiBcIkdFVCwgT1BUSU9OU1wiLFxuICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiOiBcIkF1dGhvcml6YXRpb24sIENvbnRlbnQtVHlwZSwgQ2FjaGUtQ29udHJvbCwgUHJhZ21hXCIsXG4gICAgXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1DcmVkZW50aWFsc1wiOiBcInRydWVcIixcbiAgICBcIkFjY2Vzcy1Db250cm9sLU1heC1BZ2VcIjogXCI4NjQwMFwiLFxuICAgIFZhcnk6IFwiT3JpZ2luXCJcbiAgfTtcbn1cblxuZnVuY3Rpb24ganNvbldpdGhIZWFkZXJzKFxuICBib2R5OiB1bmtub3duLFxuICBzdGF0dXM6IG51bWJlcixcbiAgb3JpZ2luOiBzdHJpbmcgfCBudWxsLFxuICBleHRyYUhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4pIHtcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGJvZHksIHtcbiAgICBzdGF0dXMsXG4gICAgaGVhZGVyczoge1xuICAgICAgLi4uZ2V0Q29yc0hlYWRlcnMob3JpZ2luKSxcbiAgICAgIC4uLihleHRyYUhlYWRlcnMgPz8ge30pXG4gICAgfVxuICB9KTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbnRlcmZhY2UgQmVzdE9kZHNEYXRhIHtcbiAgYmVzdF9ib29rOiBzdHJpbmc7XG4gIGJlc3RfcHJpY2U6IG51bWJlcjtcbiAgbGluZTogbnVtYmVyO1xuICBzaWRlOiBzdHJpbmc7XG4gIHBsYXllcl9pZDogc3RyaW5nO1xuICBwbGF5ZXJfbmFtZTogc3RyaW5nO1xuICBib29rX2NvdW50OiBudW1iZXI7XG4gIHVwZGF0ZWRfYXQ6IG51bWJlcjtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFRElTIEJFU1QgT0REUyBIRUxQRVJTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEJhdGNoIGZldGNoIGJlc3Qgb2RkcyBmcm9tIFJlZGlzIGZvciBhbGwgcm93cyB3aXRoIHZhbGlkIGtleXNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hCZXN0T2Rkc0ZvclJvd3MoXG4gIHJvd3M6IEFycmF5PHsgZXZlbnRfaWQ/OiBzdHJpbmc7IG1hcmtldD86IHN0cmluZzsgc2VsX2tleT86IHN0cmluZyB9PlxuKTogUHJvbWlzZTxNYXA8c3RyaW5nLCBCZXN0T2Rkc0RhdGEgfCBudWxsPj4ge1xuICBjb25zdCByZXN1bHQgPSBuZXcgTWFwPHN0cmluZywgQmVzdE9kZHNEYXRhIHwgbnVsbD4oKTtcbiAgXG4gIC8vIEZpbHRlciByb3dzIHRoYXQgaGF2ZSBhbGwgcmVxdWlyZWQgZmllbGRzIGZvciBSZWRpcyBsb29rdXBcbiAgY29uc3QgdmFsaWRSb3dzID0gcm93cy5maWx0ZXIociA9PiByLmV2ZW50X2lkICYmIHIubWFya2V0ICYmIHIuc2VsX2tleSk7XG4gIFxuICBpZiAodmFsaWRSb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgXG4gIC8vIEJ1aWxkIFJlZGlzIGtleXNcbiAgY29uc3Qga2V5cyA9IHZhbGlkUm93cy5tYXAociA9PiBgYmVzdG9kZHM6bmJhOiR7ci5ldmVudF9pZH06JHtyLm1hcmtldH06JHtyLnNlbF9rZXl9YCk7XG4gIFxuICB0cnkge1xuICAgIC8vIEJhdGNoIGZldGNoIGFsbCBrZXlzIGluIG9uZSByb3VuZCB0cmlwXG4gICAgY29uc3QgdmFsdWVzID0gYXdhaXQgcmVkaXMubWdldDwoQmVzdE9kZHNEYXRhIHwgbnVsbClbXT4oLi4ua2V5cyk7XG4gICAgXG4gICAgLy8gTWFwIHJlc3VsdHMgYmFjayB0byBjb21wb3NpdGUga2V5cyBmb3IgZWFzeSBsb29rdXBcbiAgICB2YWxpZFJvd3MuZm9yRWFjaCgocm93LCBpKSA9PiB7XG4gICAgICBjb25zdCBjb21wb3NpdGVLZXkgPSBgJHtyb3cuZXZlbnRfaWR9OiR7cm93Lm1hcmtldH06JHtyb3cuc2VsX2tleX1gO1xuICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV07XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBib3RoIHN0cmluZyBhbmQgb2JqZWN0IHJlc3BvbnNlcyBmcm9tIFJlZGlzXG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzdWx0LnNldChjb21wb3NpdGVLZXksIEpTT04ucGFyc2UodmFsdWUpKTtcbiAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJlc3VsdC5zZXQoY29tcG9zaXRlS2V5LCBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzdWx0LnNldChjb21wb3NpdGVLZXksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LnNldChjb21wb3NpdGVLZXksIG51bGwpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIltIaXQgUmF0ZXMgdjJdIFJlZGlzIGJlc3Qgb2RkcyBmZXRjaCBlcnJvcjpcIiwgZSk7XG4gICAgLy8gUmV0dXJuIGVtcHR5IG1hcCBvbiBlcnJvciAtIGdyYWNlZnVsbHkgZGVncmFkZVxuICB9XG4gIFxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vLyBWYWxpZCBzb3J0IGZpZWxkcyBmb3IgaGl0IHJhdGVzXG5jb25zdCBWQUxJRF9TT1JUX0ZJRUxEUyA9IFtcbiAgXCJsaW5lXCIsIFwibDVBdmdcIiwgXCJsMTBBdmdcIiwgXCJzZWFzb25BdmdcIiwgXCJzdHJlYWtcIiwgXG4gIFwibDVQY3RcIiwgXCJsMTBQY3RcIiwgXCJsMjBQY3RcIiwgXCJzZWFzb25QY3RcIiwgXCJoMmhQY3RcIiwgXCJtYXRjaHVwUmFua1wiXG5dIGFzIGNvbnN0O1xuXG5jb25zdCBRdWVyeVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZGF0ZTogelxuICAgIC5zdHJpbmcoKVxuICAgIC5vcHRpb25hbCgpXG4gICAgLnJlZmluZShcbiAgICAgICh2YWx1ZSkgPT4gIXZhbHVlIHx8IC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0kLy50ZXN0KHZhbHVlKSxcbiAgICAgIFwiZGF0ZSBtdXN0IGJlIFlZWVktTU0tRERcIlxuICAgICksXG4gIG1hcmtldDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBtaW5IaXRSYXRlOiB6LmNvZXJjZS5udW1iZXIoKS5taW4oMCkubWF4KDEwMCkub3B0aW9uYWwoKSxcbiAgbGltaXQ6IHouY29lcmNlLm51bWJlcigpLm1pbigxKS5tYXgoNTAwMCkub3B0aW9uYWwoKSxcbiAgb2Zmc2V0OiB6LmNvZXJjZS5udW1iZXIoKS5taW4oMCkub3B0aW9uYWwoKSxcbiAgc2VhcmNoOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHBsYXllcklkOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLm9wdGlvbmFsKCksXG4gIHNvcnQ6IHouZW51bShWQUxJRF9TT1JUX0ZJRUxEUykub3B0aW9uYWwoKSxcbiAgc29ydERpcjogei5lbnVtKFtcImFzY1wiLCBcImRlc2NcIl0pLm9wdGlvbmFsKCksXG4gIHNraXBDYWNoZTogei5jb2VyY2UuYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gIGhhc09kZHM6IHouY29lcmNlLmJvb2xlYW4oKS5vcHRpb25hbCgpLCAvLyBGaWx0ZXIgZm9yIHByb2ZpbGVzIHdpdGggb2Rkc1xufSk7XG5cbmNvbnN0IERFRkFVTFRfTElNSVQgPSA1MDA7IC8vIEZldGNoIG1vcmUgZm9yIGNsaWVudC1zaWRlIHNvcnRpbmdcbi8vIE5vIGRlZmF1bHQgbWFya2V0IC0gd2hlbiBudWxsLCBmZXRjaCBBTEwgbWFya2V0cyBmb3IgZmxleGlibGUgY2xpZW50LXNpZGUgZmlsdGVyaW5nXG5cbi8vIEdldCBjdXJyZW50IEVUIGRhdGVcbmZ1bmN0aW9uIGdldEVURGF0ZShvZmZzZXREYXlzID0gMCk6IHN0cmluZyB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIG5vdy5zZXREYXRlKG5vdy5nZXREYXRlKCkgKyBvZmZzZXREYXlzKTtcbiAgcmV0dXJuIG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KCdlbi1DQScsIHtcbiAgICB0aW1lWm9uZTogJ0FtZXJpY2EvTmV3X1lvcmsnLFxuICAgIHllYXI6ICdudW1lcmljJyxcbiAgICBtb250aDogJzItZGlnaXQnLFxuICAgIGRheTogJzItZGlnaXQnLFxuICB9KS5mb3JtYXQobm93KTtcbn1cblxuLy8gR2VuZXJhdGUgY2FjaGUga2V5XG5mdW5jdGlvbiBnZXRDYWNoZUtleShkYXRlczogc3RyaW5nW10sIG1hcmtldD86IHN0cmluZyB8IG51bGwsIGhhc09kZHM/OiBib29sZWFuKTogc3RyaW5nIHtcbiAgY29uc3QgZGF0ZUtleSA9IGRhdGVzLnNvcnQoKS5qb2luKFwiX1wiKTtcbiAgY29uc3QgbWFya2V0S2V5ID0gbWFya2V0IHx8IFwiYWxsXCI7XG4gIGNvbnN0IG9kZHNLZXkgPSBoYXNPZGRzID8gXCJvZGRzXCIgOiBcImFsbFwiO1xuICByZXR1cm4gYCR7Q0FDSEVfS0VZX1BSRUZJWH06JHtkYXRlS2V5fToke21hcmtldEtleX06JHtvZGRzS2V5fWA7XG59XG5cbi8vIFRyYW5zZm9ybSBSUEMgcmVzcG9uc2UgdG8gZnJvbnRlbmQgZm9ybWF0XG5mdW5jdGlvbiB0cmFuc2Zvcm1Qcm9maWxlKHJvdzogYW55LCBiZXN0T2RkczogQmVzdE9kZHNEYXRhIHwgbnVsbCkge1xuICAvLyBEZXRlcm1pbmUgbWF0Y2h1cCBxdWFsaXR5IGZyb20gZHZwX3JhbmtcbiAgbGV0IG1hdGNodXBRdWFsaXR5OiBcImZhdm9yYWJsZVwiIHwgXCJuZXV0cmFsXCIgfCBcInVuZmF2b3JhYmxlXCIgfCBudWxsID0gbnVsbDtcbiAgaWYgKHJvdy5kdnBfcmFuaykge1xuICAgIGlmIChyb3cuZHZwX3JhbmsgPD0gMTApIG1hdGNodXBRdWFsaXR5ID0gXCJ1bmZhdm9yYWJsZVwiOyAvLyBUb3VnaCBkZWZlbnNlXG4gICAgZWxzZSBpZiAocm93LmR2cF9yYW5rID49IDIxKSBtYXRjaHVwUXVhbGl0eSA9IFwiZmF2b3JhYmxlXCI7IC8vIFdlYWsgZGVmZW5zZVxuICAgIGVsc2UgbWF0Y2h1cFF1YWxpdHkgPSBcIm5ldXRyYWxcIjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaWQ6IHJvdy5pZCxcbiAgICBwbGF5ZXJfaWQ6IHJvdy5wbGF5ZXJfaWQsXG4gICAgcGxheWVyX25hbWU6IHJvdy5wbGF5ZXJfbmFtZSxcbiAgICB0ZWFtX2lkOiByb3cudGVhbV9pZCxcbiAgICBtYXJrZXQ6IHJvdy5tYXJrZXQsXG4gICAgbGluZTogcm93LmxpbmUsXG4gICAgb3Bwb25lbnRfdGVhbV9pZDogcm93Lm9wcG9uZW50X3RlYW1faWQsXG4gICAgZ2FtZV9pZDogcm93LmdhbWVfaWQsXG4gICAgZ2FtZV9kYXRlOiByb3cuZ2FtZV9kYXRlLFxuICAgIGxhc3RfNV9wY3Q6IHJvdy5sYXN0XzVfcGN0LFxuICAgIGxhc3RfMTBfcGN0OiByb3cubGFzdF8xMF9wY3QsXG4gICAgbGFzdF8yMF9wY3Q6IHJvdy5sYXN0XzIwX3BjdCxcbiAgICBzZWFzb25fcGN0OiByb3cuc2Vhc29uX3BjdCxcbiAgICBoMmhfcGN0OiByb3cuaDJoX3BjdCxcbiAgICBoMmhfYXZnOiByb3cuaDJoX2F2ZyxcbiAgICBoMmhfZ2FtZXM6IHJvdy5oMmhfZ2FtZXMsXG4gICAgaGl0X3N0cmVhazogcm93LmhpdF9zdHJlYWssXG4gICAgbGFzdF81X2F2Zzogcm93Lmxhc3RfNV9hdmcsXG4gICAgbGFzdF8xMF9hdmc6IHJvdy5sYXN0XzEwX2F2ZyxcbiAgICBsYXN0XzIwX2F2Zzogcm93Lmxhc3RfMjBfYXZnLFxuICAgIHNlYXNvbl9hdmc6IHJvdy5zZWFzb25fYXZnLFxuICAgIHNwcmVhZDogcm93LnNwcmVhZCxcbiAgICB0b3RhbDogcm93LnRvdGFsLFxuICAgIHNwcmVhZF9jbHY6IHJvdy5zcHJlYWRfY2x2LFxuICAgIHRvdGFsX2Nsdjogcm93LnRvdGFsX2NsdixcbiAgICBpbmp1cnlfc3RhdHVzOiByb3cuaW5qdXJ5X3N0YXR1cyxcbiAgICBpbmp1cnlfbm90ZXM6IHJvdy5pbmp1cnlfbm90ZXMsXG4gICAgdGVhbV9uYW1lOiByb3cudGVhbV9uYW1lLFxuICAgIHRlYW1fYWJicjogcm93LnRlYW1fYWJicixcbiAgICBvcHBvbmVudF90ZWFtX25hbWU6IHJvdy5vcHBvbmVudF90ZWFtX25hbWUsXG4gICAgb3Bwb25lbnRfdGVhbV9hYmJyOiByb3cub3Bwb25lbnRfdGVhbV9hYmJyLFxuICAgIHBsYXllcl9wb3NpdGlvbjogcm93LnBsYXllcl9wb3NpdGlvbiB8fCByb3cucGxheWVyX2RlcHRoX2NoYXJ0X3BvcyxcbiAgICBqZXJzZXlfbnVtYmVyOiByb3cuamVyc2V5X251bWJlcixcbiAgICBjcmVhdGVkX2F0OiByb3cuY3JlYXRlZF9hdCxcbiAgICB1cGRhdGVkX2F0OiByb3cudXBkYXRlZF9hdCxcbiAgICBob21lX2F3YXk6IHJvdy5ob21lX2F3YXksXG4gICAgbmF0aW9uYWxfYnJvYWRjYXN0OiByb3cubmF0aW9uYWxfYnJvYWRjYXN0LFxuICAgIGlzX3ByaW1ldGltZTogcm93LmlzX3ByaW1ldGltZSxcbiAgICBvZGRzX3NlbGVjdGlvbl9pZDogcm93Lm9kZHNfc2VsZWN0aW9uX2lkLFxuICAgIGV2ZW50X2lkOiByb3cuZXZlbnRfaWQsXG4gICAgaXNfYmFja190b19iYWNrOiByb3cuaXNfYmFja190b19iYWNrLFxuICAgIC8vIE5ldyBmaWVsZCBmcm9tIHYzIFJQQyAtIG5lZWRlZCBmb3IgUmVkaXMgbG9va3VwXG4gICAgc2VsX2tleTogcm93LnNlbF9rZXksXG4gICAgLy8gTGl2ZSBiZXN0IG9kZHMgZnJvbSBSZWRpc1xuICAgIGJlc3Rfb2RkczogYmVzdE9kZHMgPyB7XG4gICAgICBib29rOiBiZXN0T2Rkcy5iZXN0X2Jvb2ssXG4gICAgICBwcmljZTogYmVzdE9kZHMuYmVzdF9wcmljZSxcbiAgICAgIHVwZGF0ZWRfYXQ6IGJlc3RPZGRzLnVwZGF0ZWRfYXQsXG4gICAgfSA6IG51bGwsXG4gICAgYm9va3M6IGJlc3RPZGRzPy5ib29rX2NvdW50ID8/IDAsXG4gICAgLy8gUGxheWVyIGluZm8gKG5vdyBkZW5vcm1hbGl6ZWQpXG4gICAgbmJhX3BsYXllcnNfaHI6IHJvdy5wbGF5ZXJfbmFtZSA/IHtcbiAgICAgIG5iYV9wbGF5ZXJfaWQ6IHJvdy5wbGF5ZXJfaWQsXG4gICAgICBuYW1lOiByb3cucGxheWVyX25hbWUsXG4gICAgICBwb3NpdGlvbjogcm93LnBsYXllcl9kZXB0aF9jaGFydF9wb3MgfHwgcm93LnBsYXllcl9wb3NpdGlvbixcbiAgICAgIGRlcHRoX2NoYXJ0X3Bvczogcm93LnBsYXllcl9kZXB0aF9jaGFydF9wb3MsXG4gICAgICBqZXJzZXlfbnVtYmVyOiByb3cuamVyc2V5X251bWJlcixcbiAgICB9IDogbnVsbCxcbiAgICAvLyBHYW1lIGluZm8gKG5vdyBkZW5vcm1hbGl6ZWQpXG4gICAgbmJhX2dhbWVzX2hyOiB7XG4gICAgICBnYW1lX2RhdGU6IHJvdy5nYW1lX2RhdGUsXG4gICAgICBob21lX3RlYW1fbmFtZTogcm93LmhvbWVfdGVhbV9uYW1lLFxuICAgICAgYXdheV90ZWFtX25hbWU6IHJvdy5hd2F5X3RlYW1fbmFtZSxcbiAgICAgIGdhbWVfc3RhdHVzOiByb3cuZ2FtZV9zdGF0dXMsXG4gICAgfSxcbiAgICAvLyBUZWFtIGNvbG9ycyAobm93IGRlbm9ybWFsaXplZCAtIG5vIGFjY2VudF9jb2xvciBpbiB0YWJsZSB5ZXQpXG4gICAgbmJhX3RlYW1zOiByb3cucHJpbWFyeV9jb2xvciA/IHtcbiAgICAgIHByaW1hcnlfY29sb3I6IHJvdy5wcmltYXJ5X2NvbG9yLFxuICAgICAgc2Vjb25kYXJ5X2NvbG9yOiByb3cuc2Vjb25kYXJ5X2NvbG9yLFxuICAgICAgYWNjZW50X2NvbG9yOiBudWxsLCAvLyBOb3QgaW4gdGFibGUgeWV0XG4gICAgfSA6IG51bGwsXG4gICAgLy8gTWF0Y2h1cC9EdlAgZGF0YSAobm93IHByZS1jb21wdXRlZCBpbiB0YWJsZSAtIG5vIGR2cF9hdmdfYWxsb3dlZCB5ZXQpXG4gICAgbWF0Y2h1cDogcm93LmR2cF9yYW5rID8ge1xuICAgICAgcGxheWVyX2lkOiByb3cucGxheWVyX2lkLFxuICAgICAgbWFya2V0OiByb3cubWFya2V0LFxuICAgICAgb3Bwb25lbnRfdGVhbV9pZDogcm93Lm9wcG9uZW50X3RlYW1faWQsXG4gICAgICBwbGF5ZXJfcG9zaXRpb246IHJvdy5wbGF5ZXJfZGVwdGhfY2hhcnRfcG9zIHx8IHJvdy5wbGF5ZXJfcG9zaXRpb24sXG4gICAgICBtYXRjaHVwX3Jhbms6IHJvdy5kdnBfcmFuayxcbiAgICAgIHJhbmtfbGFiZWw6IHJvdy5kdnBfbGFiZWwsXG4gICAgICBhdmdfYWxsb3dlZDogbnVsbCwgLy8gTm90IGluIHRhYmxlIHlldFxuICAgICAgbWF0Y2h1cF9xdWFsaXR5OiBtYXRjaHVwUXVhbGl0eSxcbiAgICB9IDogbnVsbCxcbiAgfTtcbn1cblxuLy8gU29ydCBkYXRhIGNsaWVudC1zaWRlIGZvciBmbGV4aWJpbGl0eVxuZnVuY3Rpb24gc29ydERhdGEoZGF0YTogYW55W10sIHNvcnQ6IHN0cmluZywgc29ydERpcjogXCJhc2NcIiB8IFwiZGVzY1wiKTogYW55W10ge1xuICBjb25zdCBtdWx0aXBsaWVyID0gc29ydERpciA9PT0gXCJhc2NcIiA/IDEgOiAtMTtcbiAgXG4gIGNvbnN0IGZpZWxkTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgIFwibGluZVwiOiBcImxpbmVcIixcbiAgICBcImw1QXZnXCI6IFwibGFzdF81X2F2Z1wiLFxuICAgIFwibDEwQXZnXCI6IFwibGFzdF8xMF9hdmdcIixcbiAgICBcInNlYXNvbkF2Z1wiOiBcInNlYXNvbl9hdmdcIixcbiAgICBcInN0cmVha1wiOiBcImhpdF9zdHJlYWtcIixcbiAgICBcImw1UGN0XCI6IFwibGFzdF81X3BjdFwiLFxuICAgIFwibDEwUGN0XCI6IFwibGFzdF8xMF9wY3RcIixcbiAgICBcImwyMFBjdFwiOiBcImxhc3RfMjBfcGN0XCIsXG4gICAgXCJzZWFzb25QY3RcIjogXCJzZWFzb25fcGN0XCIsXG4gICAgXCJoMmhQY3RcIjogXCJoMmhfcGN0XCIsXG4gICAgXCJtYXRjaHVwUmFua1wiOiBcImR2cF9yYW5rXCIsXG4gIH07XG4gIFxuICBjb25zdCBkYkZpZWxkID0gZmllbGRNYXBbc29ydF07XG4gIGlmICghZGJGaWVsZCkgcmV0dXJuIGRhdGE7XG4gIFxuICByZXR1cm4gWy4uLmRhdGFdLnNvcnQoKGEsIGIpID0+IHtcbiAgICBjb25zdCBhVmFsID0gYVtkYkZpZWxkXTtcbiAgICBjb25zdCBiVmFsID0gYltkYkZpZWxkXTtcbiAgICBcbiAgICAvLyBBTFdBWVMgcHVzaCBudWxscyB0byB0aGUgRU5EIG9mIHRoZSBsaXN0XG4gICAgaWYgKGFWYWwgPT09IG51bGwgJiYgYlZhbCA9PT0gbnVsbCkgcmV0dXJuIDA7XG4gICAgaWYgKGFWYWwgPT09IG51bGwpIHJldHVybiAxOyAgLy8gYSBnb2VzIGFmdGVyIGJcbiAgICBpZiAoYlZhbCA9PT0gbnVsbCkgcmV0dXJuIC0xOyAvLyBiIGdvZXMgYWZ0ZXIgYVxuICAgIFxuICAgIHJldHVybiAoYVZhbCAtIGJWYWwpICogbXVsdGlwbGllcjtcbiAgfSk7XG59XG5cbi8vIEZpbHRlciBkYXRhIGJ5IHNlYXJjaC9tYXJrZXQvcGxheWVyXG5mdW5jdGlvbiBmaWx0ZXJEYXRhKFxuICBkYXRhOiBhbnlbXSwgXG4gIHNlYXJjaD86IHN0cmluZywgXG4gIG1hcmtldD86IHN0cmluZywgXG4gIHBsYXllcklkPzogbnVtYmVyXG4pOiBhbnlbXSB7XG4gIGxldCByZXN1bHQgPSBkYXRhO1xuICBcbiAgaWYgKHNlYXJjaD8udHJpbSgpKSB7XG4gICAgY29uc3Qgc2VhcmNoTG93ZXIgPSBzZWFyY2gudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihyb3cgPT4gXG4gICAgICByb3cucGxheWVyX25hbWU/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoTG93ZXIpIHx8XG4gICAgICByb3cudGVhbV9uYW1lPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxuICAgICAgcm93LnRlYW1fYWJicj8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hMb3dlcilcbiAgICApO1xuICB9XG4gIFxuICBpZiAobWFya2V0KSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihyb3cgPT4gcm93Lm1hcmtldCA9PT0gbWFya2V0KTtcbiAgfVxuICBcbiAgaWYgKHBsYXllcklkKSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihyb3cgPT4gcm93LnBsYXllcl9pZCA9PT0gcGxheWVySWQpO1xuICB9XG4gIFxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gT1BUSU9OUyhyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShudWxsLCB7XG4gICAgc3RhdHVzOiAyMDQsXG4gICAgaGVhZGVyczogZ2V0Q29yc0hlYWRlcnMocmVxdWVzdC5oZWFkZXJzLmdldChcIm9yaWdpblwiKSlcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgY29uc3Qgb3JpZ2luID0gcmVxdWVzdC5oZWFkZXJzLmdldChcIm9yaWdpblwiKTtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gIFxuICBjb25zdCBxdWVyeSA9IFF1ZXJ5U2NoZW1hLnNhZmVQYXJzZSh7XG4gICAgZGF0ZTogdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJkYXRlXCIpID8/IHVuZGVmaW5lZCxcbiAgICBtYXJrZXQ6IHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwibWFya2V0XCIpID8/IHVuZGVmaW5lZCxcbiAgICBtaW5IaXRSYXRlOiB1cmwuc2VhcmNoUGFyYW1zLmdldChcIm1pbkhpdFJhdGVcIikgPz8gdW5kZWZpbmVkLFxuICAgIGxpbWl0OiB1cmwuc2VhcmNoUGFyYW1zLmdldChcImxpbWl0XCIpID8/IHVuZGVmaW5lZCxcbiAgICBvZmZzZXQ6IHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwib2Zmc2V0XCIpID8/IHVuZGVmaW5lZCxcbiAgICBzZWFyY2g6IHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwic2VhcmNoXCIpID8/IHVuZGVmaW5lZCxcbiAgICBwbGF5ZXJJZDogdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJwbGF5ZXJJZFwiKSA/PyB1bmRlZmluZWQsXG4gICAgc29ydDogdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJzb3J0XCIpID8/IHVuZGVmaW5lZCxcbiAgICBzb3J0RGlyOiB1cmwuc2VhcmNoUGFyYW1zLmdldChcInNvcnREaXJcIikgPz8gdW5kZWZpbmVkLFxuICAgIHNraXBDYWNoZTogdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJza2lwQ2FjaGVcIikgPz8gdW5kZWZpbmVkLFxuICAgIGhhc09kZHM6IHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwiaGFzT2Rkc1wiKSA/PyB1bmRlZmluZWQsXG4gIH0pO1xuXG4gIGlmICghcXVlcnkuc3VjY2Vzcykge1xuICAgIHJldHVybiBqc29uV2l0aEhlYWRlcnMoXG4gICAgICB7IGVycm9yOiBcIkludmFsaWQgcXVlcnkgcGFyYW1zXCIsIGRldGFpbHM6IHF1ZXJ5LmVycm9yLmZsYXR0ZW4oKSB9LFxuICAgICAgNDAwLFxuICAgICAgb3JpZ2luXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IHsgXG4gICAgZGF0ZSwgXG4gICAgbWFya2V0OiByYXdNYXJrZXQsIFxuICAgIG1pbkhpdFJhdGUsIFxuICAgIGxpbWl0ID0gREVGQVVMVF9MSU1JVCwgXG4gICAgb2Zmc2V0ID0gMCwgXG4gICAgc2VhcmNoLCBcbiAgICBwbGF5ZXJJZCxcbiAgICBzb3J0ID0gXCJsMTBQY3RcIixcbiAgICBzb3J0RGlyID0gXCJkZXNjXCIsXG4gICAgc2tpcENhY2hlID0gZmFsc2UsXG4gICAgaGFzT2RkcyA9IHRydWUsIC8vIERlZmF1bHQgdG8gb25seSBwcm9maWxlcyB3aXRoIG9kZHNcbiAgfSA9IHF1ZXJ5LmRhdGE7XG4gIFxuICAvLyBXaGVuIG5vIG1hcmtldCBzcGVjaWZpZWQsIGZldGNoIEFMTCBtYXJrZXRzIChjbGllbnQgZmlsdGVycyBhcyBuZWVkZWQpXG4gIGNvbnN0IG1hcmtldCA9IHJhd01hcmtldCB8fCBudWxsO1xuXG4gIGNvbnN0IHRvZGF5RVQgPSBnZXRFVERhdGUoKTtcbiAgY29uc3QgdG9tb3Jyb3dFVCA9IGdldEVURGF0ZSgxKTtcbiAgXG4gIC8vIERldGVybWluZSBkYXRlcyB0byBmZXRjaFxuICBjb25zdCBkYXRlc1RvRmV0Y2ggPSBkYXRlID8gW2RhdGVdIDogW3RvZGF5RVQsIHRvbW9ycm93RVRdO1xuICBcbiAgdHJ5IHtcbiAgICBsZXQgYWxsRGF0YTogYW55W10gPSBbXTtcbiAgICBsZXQgY2FjaGVIaXQgPSBmYWxzZTtcbiAgICBcbiAgICAvLyBUcnkgY2FjaGUgZmlyc3QgKHVubGVzcyBzZWFyY2gvcGxheWVyIGZpbHRlciBvciBza2lwQ2FjaGUpXG4gICAgY29uc3QgY2FuVXNlQ2FjaGUgPSAhc2VhcmNoICYmICFwbGF5ZXJJZCAmJiAhc2tpcENhY2hlO1xuICAgIFxuICAgIGlmIChjYW5Vc2VDYWNoZSkge1xuICAgICAgY29uc3QgY2FjaGVLZXkgPSBnZXRDYWNoZUtleShkYXRlc1RvRmV0Y2gsIG1hcmtldCwgaGFzT2Rkcyk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCByZWRpcy5nZXQ8eyBkYXRhOiBhbnlbXTsgdHM6IG51bWJlciB9PihjYWNoZUtleSk7XG4gICAgICAgIGlmIChjYWNoZWQgJiYgY2FjaGVkLmRhdGEpIHtcbiAgICAgICAgICBhbGxEYXRhID0gY2FjaGVkLmRhdGE7XG4gICAgICAgICAgY2FjaGVIaXQgPSB0cnVlO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBbSGl0IFJhdGVzIHYyXSBDYWNoZSBISVQgKCR7YWxsRGF0YS5sZW5ndGh9IHByb2ZpbGVzKSBpbiAke0RhdGUubm93KCkgLSBzdGFydFRpbWV9bXNgKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiW0hpdCBSYXRlcyB2Ml0gQ2FjaGUgcmVhZCBlcnJvcjpcIiwgZSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENhY2hlIG1pc3MgLSBmZXRjaCBmcm9tIFN1cGFiYXNlIHVzaW5nIEZBU1QgUlBDXG4gICAgaWYgKCFjYWNoZUhpdCkge1xuICAgICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCgpO1xuICAgICAgY29uc3QgZGJTdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgXG4gICAgICAvLyBDYWxsIHRoZSBuZXcgb3B0aW1pemVkIFJQQyBmdW5jdGlvbiAodjMgaW5jbHVkZXMgc2VsX2tleSBmb3IgUmVkaXMgbG9va3VwKVxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKFwiZ2V0X25iYV9oaXRfcmF0ZV9wcm9maWxlc19mYXN0X3YzXCIsIHtcbiAgICAgICAgcF9kYXRlczogZGF0ZXNUb0ZldGNoLFxuICAgICAgICBwX21hcmtldDogbWFya2V0IHx8IG51bGwsXG4gICAgICAgIHBfaGFzX29kZHM6IGhhc09kZHMsXG4gICAgICAgIHBfbGltaXQ6IG1hcmtldCA/IDUwMCA6IDMwMDAsIC8vIDUwMCBwZXIgbWFya2V0LCAzMDAwIGZvciBhbGwgbWFya2V0c1xuICAgICAgICBwX29mZnNldDogMCxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIltIaXQgUmF0ZXMgdjJdIFJQQyBlcnJvcjpcIiwgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIHJldHVybiBqc29uV2l0aEhlYWRlcnMoXG4gICAgICAgICAgeyBlcnJvcjogXCJEYXRhYmFzZSBlcnJvclwiLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICAgICAgNTAwLFxuICAgICAgICAgIG9yaWdpblxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgXG4gICAgICBhbGxEYXRhID0gZGF0YSB8fCBbXTtcbiAgICAgIFxuICAgICAgY29uc3QgZGJUaW1lID0gRGF0ZS5ub3coKSAtIGRiU3RhcnRUaW1lO1xuICAgICAgY29uc3Qgd2l0aE9kZHNDb3VudCA9IGFsbERhdGEuZmlsdGVyKChyOiBhbnkpID0+IHIub2Rkc19zZWxlY3Rpb25faWQpLmxlbmd0aDtcbiAgICAgIGNvbnNvbGUubG9nKGBbSGl0IFJhdGVzIHYyXSBSUEMgZmV0Y2g6ICR7YWxsRGF0YS5sZW5ndGh9IHByb2ZpbGVzICgke3dpdGhPZGRzQ291bnR9IHdpdGggb2RkcykgaW4gJHtkYlRpbWV9bXNgKTtcbiAgICAgIFxuICAgICAgLy8gQ2FjaGUgdGhlIGRhdGFcbiAgICAgIGlmIChjYW5Vc2VDYWNoZSAmJiBhbGxEYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBnZXRDYWNoZUtleShkYXRlc1RvRmV0Y2gsIG1hcmtldCwgaGFzT2Rkcyk7XG4gICAgICAgIHJlZGlzLnNldChjYWNoZUtleSwge1xuICAgICAgICAgIGRhdGE6IGFsbERhdGEsXG4gICAgICAgICAgdHM6IERhdGUubm93KCksXG4gICAgICAgIH0sIHsgZXg6IENBQ0hFX1RUTF9TRUNPTkRTIH0pLmNhdGNoKGUgPT4gXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIltIaXQgUmF0ZXMgdjJdIENhY2hlIHdyaXRlIGVycm9yOlwiLCBlKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBBcHBseSBjbGllbnQtc2lkZSBmaWx0ZXJzIChmb3Igc2VhcmNoL3BsYXllcklkIHdoaWNoIGJ5cGFzcyBjYWNoZSlcbiAgICBsZXQgZmlsdGVyZWREYXRhID0gZmlsdGVyRGF0YShhbGxEYXRhLCBzZWFyY2gsIHVuZGVmaW5lZCwgcGxheWVySWQpO1xuICAgIFxuICAgIC8vIEFwcGx5IHNvcnRpbmdcbiAgICBmaWx0ZXJlZERhdGEgPSBzb3J0RGF0YShmaWx0ZXJlZERhdGEsIHNvcnQsIHNvcnREaXIpO1xuICAgIFxuICAgIC8vIEFwcGx5IG1pbiBoaXQgcmF0ZSBmaWx0ZXIgaWYgc3BlY2lmaWVkXG4gICAgaWYgKG1pbkhpdFJhdGUpIHtcbiAgICAgIGZpbHRlcmVkRGF0YSA9IGZpbHRlcmVkRGF0YS5maWx0ZXIocm93ID0+IFxuICAgICAgICByb3cubGFzdF8xMF9wY3QgIT09IG51bGwgJiYgcm93Lmxhc3RfMTBfcGN0ID49IG1pbkhpdFJhdGVcbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIEFwcGx5IHBhZ2luYXRpb25cbiAgICBjb25zdCBwYWdpbmF0ZWREYXRhID0gZmlsdGVyZWREYXRhLnNsaWNlKG9mZnNldCwgb2Zmc2V0ICsgbGltaXQpO1xuICAgIFxuICAgIC8vIEZldGNoIGxpdmUgYmVzdCBvZGRzIGZyb20gUmVkaXMgZm9yIHBhZ2luYXRlZCByb3dzXG4gICAgY29uc3QgYmVzdE9kZHNTdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGJlc3RPZGRzTWFwID0gYXdhaXQgZmV0Y2hCZXN0T2Rkc0ZvclJvd3MocGFnaW5hdGVkRGF0YSk7XG4gICAgY29uc3QgYmVzdE9kZHNUaW1lID0gRGF0ZS5ub3coKSAtIGJlc3RPZGRzU3RhcnRUaW1lO1xuICAgIGNvbnNvbGUubG9nKGBbSGl0IFJhdGVzIHYyXSBCZXN0IG9kZHMgZmV0Y2g6ICR7YmVzdE9kZHNNYXAuc2l6ZX0ga2V5cyBpbiAke2Jlc3RPZGRzVGltZX1tc2ApO1xuICAgIFxuICAgIC8vIFRyYW5zZm9ybSB0byBmcm9udGVuZCBmb3JtYXQgd2l0aCBiZXN0IG9kZHMgbWVyZ2VkXG4gICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0gcGFnaW5hdGVkRGF0YS5tYXAocm93ID0+IHtcbiAgICAgIC8vIEJ1aWxkIGNvbXBvc2l0ZSBrZXkgZm9yIGxvb2t1cFxuICAgICAgY29uc3QgY29tcG9zaXRlS2V5ID0gcm93LmV2ZW50X2lkICYmIHJvdy5tYXJrZXQgJiYgcm93LnNlbF9rZXkgXG4gICAgICAgID8gYCR7cm93LmV2ZW50X2lkfToke3Jvdy5tYXJrZXR9OiR7cm93LnNlbF9rZXl9YCBcbiAgICAgICAgOiBudWxsO1xuICAgICAgY29uc3QgYmVzdE9kZHMgPSBjb21wb3NpdGVLZXkgPyBiZXN0T2Rkc01hcC5nZXQoY29tcG9zaXRlS2V5KSA/PyBudWxsIDogbnVsbDtcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1Qcm9maWxlKHJvdywgYmVzdE9kZHMpO1xuICAgIH0pO1xuICAgIFxuICAgIC8vIEdldCB1bmlxdWUgZGF0ZXMgZnJvbSByZXNwb25zZVxuICAgIGNvbnN0IGF2YWlsYWJsZURhdGVzID0gWy4uLm5ldyBTZXQoYWxsRGF0YS5tYXAoKHI6IGFueSkgPT4gci5nYW1lX2RhdGUpKV0uc29ydCgpO1xuICAgIGNvbnN0IHByaW1hcnlEYXRlID0gYXZhaWxhYmxlRGF0ZXNbMF0gfHwgdG9kYXlFVDtcbiAgICBcbiAgICBjb25zdCByZXNwb25zZVRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIFxuICAgIHJldHVybiBqc29uV2l0aEhlYWRlcnMoXG4gICAgICB7XG4gICAgICAgIGRhdGE6IHRyYW5zZm9ybWVkRGF0YSxcbiAgICAgICAgY291bnQ6IGZpbHRlcmVkRGF0YS5sZW5ndGgsXG4gICAgICAgIG1ldGE6IHtcbiAgICAgICAgICBkYXRlOiBwcmltYXJ5RGF0ZSxcbiAgICAgICAgICBhdmFpbGFibGVEYXRlcyxcbiAgICAgICAgICBtYXJrZXQ6IG1hcmtldCA/PyBudWxsLFxuICAgICAgICAgIG1pbkhpdFJhdGU6IG1pbkhpdFJhdGUgPz8gbnVsbCxcbiAgICAgICAgICBsaW1pdCxcbiAgICAgICAgICBvZmZzZXQsXG4gICAgICAgICAgY2FjaGVIaXQsXG4gICAgICAgICAgcmVzcG9uc2VUaW1lLFxuICAgICAgICAgIGhhc01vcmU6IGZpbHRlcmVkRGF0YS5sZW5ndGggPiBvZmZzZXQgKyBsaW1pdCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICAyMDAsXG4gICAgICBvcmlnaW4sXG4gICAgICB7IFwiQ2FjaGUtQ29udHJvbFwiOiBcInB1YmxpYywgbWF4LWFnZT0zMCwgc3RhbGUtd2hpbGUtcmV2YWxpZGF0ZT02MFwiIH1cbiAgICApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJbSGl0IFJhdGVzIHYyXSBVbmV4cGVjdGVkIGVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIGpzb25XaXRoSGVhZGVycyhcbiAgICAgIHsgZXJyb3I6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIgfSxcbiAgICAgIDUwMCxcbiAgICAgIG9yaWdpblxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJ6IiwiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJyZWRpcyIsIkNBQ0hFX1RUTF9TRUNPTkRTIiwiQ0FDSEVfS0VZX1BSRUZJWCIsInJlc29sdmVBbGxvd2VkT3JpZ2luIiwib3JpZ2luIiwiaXNMb2NhbGhvc3QiLCJ0ZXN0IiwiZ2V0Q29yc0hlYWRlcnMiLCJhbGxvd2VkT3JpZ2luIiwiVmFyeSIsImpzb25XaXRoSGVhZGVycyIsImJvZHkiLCJzdGF0dXMiLCJleHRyYUhlYWRlcnMiLCJqc29uIiwiaGVhZGVycyIsImZldGNoQmVzdE9kZHNGb3JSb3dzIiwicm93cyIsInJlc3VsdCIsIk1hcCIsInZhbGlkUm93cyIsImZpbHRlciIsInIiLCJldmVudF9pZCIsIm1hcmtldCIsInNlbF9rZXkiLCJsZW5ndGgiLCJrZXlzIiwibWFwIiwidmFsdWVzIiwibWdldCIsImZvckVhY2giLCJyb3ciLCJpIiwiY29tcG9zaXRlS2V5IiwidmFsdWUiLCJzZXQiLCJKU09OIiwicGFyc2UiLCJlIiwiY29uc29sZSIsImVycm9yIiwiVkFMSURfU09SVF9GSUVMRFMiLCJRdWVyeVNjaGVtYSIsIm9iamVjdCIsImRhdGUiLCJzdHJpbmciLCJvcHRpb25hbCIsInJlZmluZSIsIm1pbkhpdFJhdGUiLCJjb2VyY2UiLCJudW1iZXIiLCJtaW4iLCJtYXgiLCJsaW1pdCIsIm9mZnNldCIsInNlYXJjaCIsInBsYXllcklkIiwiaW50IiwicG9zaXRpdmUiLCJzb3J0IiwiZW51bSIsInNvcnREaXIiLCJza2lwQ2FjaGUiLCJib29sZWFuIiwiaGFzT2RkcyIsIkRFRkFVTFRfTElNSVQiLCJnZXRFVERhdGUiLCJvZmZzZXREYXlzIiwibm93IiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwiSW50bCIsIkRhdGVUaW1lRm9ybWF0IiwidGltZVpvbmUiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJmb3JtYXQiLCJnZXRDYWNoZUtleSIsImRhdGVzIiwiZGF0ZUtleSIsImpvaW4iLCJtYXJrZXRLZXkiLCJvZGRzS2V5IiwidHJhbnNmb3JtUHJvZmlsZSIsImJlc3RPZGRzIiwibWF0Y2h1cFF1YWxpdHkiLCJkdnBfcmFuayIsImlkIiwicGxheWVyX2lkIiwicGxheWVyX25hbWUiLCJ0ZWFtX2lkIiwibGluZSIsIm9wcG9uZW50X3RlYW1faWQiLCJnYW1lX2lkIiwiZ2FtZV9kYXRlIiwibGFzdF81X3BjdCIsImxhc3RfMTBfcGN0IiwibGFzdF8yMF9wY3QiLCJzZWFzb25fcGN0IiwiaDJoX3BjdCIsImgyaF9hdmciLCJoMmhfZ2FtZXMiLCJoaXRfc3RyZWFrIiwibGFzdF81X2F2ZyIsImxhc3RfMTBfYXZnIiwibGFzdF8yMF9hdmciLCJzZWFzb25fYXZnIiwic3ByZWFkIiwidG90YWwiLCJzcHJlYWRfY2x2IiwidG90YWxfY2x2IiwiaW5qdXJ5X3N0YXR1cyIsImluanVyeV9ub3RlcyIsInRlYW1fbmFtZSIsInRlYW1fYWJiciIsIm9wcG9uZW50X3RlYW1fbmFtZSIsIm9wcG9uZW50X3RlYW1fYWJiciIsInBsYXllcl9wb3NpdGlvbiIsInBsYXllcl9kZXB0aF9jaGFydF9wb3MiLCJqZXJzZXlfbnVtYmVyIiwiY3JlYXRlZF9hdCIsInVwZGF0ZWRfYXQiLCJob21lX2F3YXkiLCJuYXRpb25hbF9icm9hZGNhc3QiLCJpc19wcmltZXRpbWUiLCJvZGRzX3NlbGVjdGlvbl9pZCIsImlzX2JhY2tfdG9fYmFjayIsImJlc3Rfb2RkcyIsImJvb2siLCJiZXN0X2Jvb2siLCJwcmljZSIsImJlc3RfcHJpY2UiLCJib29rcyIsImJvb2tfY291bnQiLCJuYmFfcGxheWVyc19ociIsIm5iYV9wbGF5ZXJfaWQiLCJuYW1lIiwicG9zaXRpb24iLCJkZXB0aF9jaGFydF9wb3MiLCJuYmFfZ2FtZXNfaHIiLCJob21lX3RlYW1fbmFtZSIsImF3YXlfdGVhbV9uYW1lIiwiZ2FtZV9zdGF0dXMiLCJuYmFfdGVhbXMiLCJwcmltYXJ5X2NvbG9yIiwic2Vjb25kYXJ5X2NvbG9yIiwiYWNjZW50X2NvbG9yIiwibWF0Y2h1cCIsIm1hdGNodXBfcmFuayIsInJhbmtfbGFiZWwiLCJkdnBfbGFiZWwiLCJhdmdfYWxsb3dlZCIsIm1hdGNodXBfcXVhbGl0eSIsInNvcnREYXRhIiwiZGF0YSIsIm11bHRpcGxpZXIiLCJmaWVsZE1hcCIsImRiRmllbGQiLCJhIiwiYiIsImFWYWwiLCJiVmFsIiwiZmlsdGVyRGF0YSIsInRyaW0iLCJzZWFyY2hMb3dlciIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJPUFRJT05TIiwicmVxdWVzdCIsImdldCIsIkdFVCIsInN0YXJ0VGltZSIsInVybCIsIlVSTCIsInF1ZXJ5Iiwic2FmZVBhcnNlIiwic2VhcmNoUGFyYW1zIiwidW5kZWZpbmVkIiwic3VjY2VzcyIsImRldGFpbHMiLCJmbGF0dGVuIiwicmF3TWFya2V0IiwidG9kYXlFVCIsInRvbW9ycm93RVQiLCJkYXRlc1RvRmV0Y2giLCJhbGxEYXRhIiwiY2FjaGVIaXQiLCJjYW5Vc2VDYWNoZSIsImNhY2hlS2V5IiwiY2FjaGVkIiwibG9nIiwic3VwYWJhc2UiLCJkYlN0YXJ0VGltZSIsInJwYyIsInBfZGF0ZXMiLCJwX21hcmtldCIsInBfaGFzX29kZHMiLCJwX2xpbWl0IiwicF9vZmZzZXQiLCJtZXNzYWdlIiwiZGJUaW1lIiwid2l0aE9kZHNDb3VudCIsInRzIiwiZXgiLCJjYXRjaCIsImZpbHRlcmVkRGF0YSIsInBhZ2luYXRlZERhdGEiLCJzbGljZSIsImJlc3RPZGRzU3RhcnRUaW1lIiwiYmVzdE9kZHNNYXAiLCJiZXN0T2Rkc1RpbWUiLCJzaXplIiwidHJhbnNmb3JtZWREYXRhIiwiYXZhaWxhYmxlRGF0ZXMiLCJTZXQiLCJwcmltYXJ5RGF0ZSIsInJlc3BvbnNlVGltZSIsImNvdW50IiwibWV0YSIsImhhc01vcmUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/nba/hit-rates/v2/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/redis.ts":
/*!**********************!*\
  !*** ./lib/redis.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CACHE_TTL: () => (/* binding */ CACHE_TTL),\n/* harmony export */   filterCachedOddsBySelectedSportsbooks: () => (/* binding */ filterCachedOddsBySelectedSportsbooks),\n/* harmony export */   generateCacheKey: () => (/* binding */ generateCacheKey),\n/* harmony export */   generateOddsCacheKey: () => (/* binding */ generateOddsCacheKey),\n/* harmony export */   getCachedData: () => (/* binding */ getCachedData),\n/* harmony export */   getCachedOdds: () => (/* binding */ getCachedOdds),\n/* harmony export */   getMarketsCachedData: () => (/* binding */ getMarketsCachedData),\n/* harmony export */   hasAllRequestedMarkets: () => (/* binding */ hasAllRequestedMarkets),\n/* harmony export */   invalidateCache: () => (/* binding */ invalidateCache),\n/* harmony export */   normalizeMarkets: () => (/* binding */ normalizeMarkets),\n/* harmony export */   redis: () => (/* binding */ redis),\n/* harmony export */   setCachedData: () => (/* binding */ setCachedData),\n/* harmony export */   setCachedOdds: () => (/* binding */ setCachedOdds)\n/* harmony export */ });\n/* harmony import */ var _upstash_redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @upstash/redis */ \"(rsc)/../../node_modules/@upstash/redis/nodejs.mjs\");\n\n// Initialize Redis client\nconst redis = new _upstash_redis__WEBPACK_IMPORTED_MODULE_0__.Redis({\n    url: process.env.UPSTASH_REDIS_REST_URL,\n    token: process.env.UPSTASH_REDIS_REST_TOKEN\n});\n// Cache TTL in seconds (20 minutes)\nconst CACHE_TTL = 1200;\n/**\n * Normalize market names for consistent cache keys\n * This ensures that \"batter_hits\" and \"batter_hits,batter_hits_alternate\"\n * can share the same cached data\n */ function normalizeMarkets(markets) {\n    // Convert to array if it's a string\n    const marketArray = typeof markets === \"string\" ? markets.split(\",\") : markets;\n    // Create a set of base markets (without _alternate suffix)\n    const baseMarkets = new Set();\n    const alternateMarkets = new Set();\n    marketArray.forEach((market)=>{\n        if (market.endsWith(\"_alternate\")) {\n            const baseMarket = market.replace(\"_alternate\", \"\");\n            alternateMarkets.add(baseMarket);\n        } else {\n            baseMarkets.add(market);\n        }\n    });\n    // Sort for consistent ordering in cache keys\n    return Array.from(baseMarkets).sort();\n}\n/**\n * Generate cache key for odds data with normalized markets\n *\n * @param params Parameters to generate the cache key\n * @returns A cache key string\n */ function generateOddsCacheKey({ sport, eventId, market }) {\n    // Build the key without bookmakers\n    let key = `odds:${sport}`;\n    // Add eventId if provided\n    if (eventId) {\n        key += `:${eventId}`;\n    }\n    // Normalize and add markets\n    const normalizedMarkets = normalizeMarkets(market);\n    key += `:${normalizedMarkets.join(\"_\")}`;\n    return key;\n}\n/**\n * Check if we have a superset of the requested markets in cache\n *\n * @param requestedMarkets The markets being requested\n * @param cachedMarkets The markets we have in cache\n * @returns True if the cached markets contain all requested markets\n */ function hasAllRequestedMarkets(requestedMarkets, cachedMarkets) {\n    // Normalize both sets of markets\n    const normalizedRequested = normalizeMarkets(requestedMarkets);\n    const normalizedCached = normalizeMarkets(cachedMarkets);\n    // Check if all requested markets are in the cached markets\n    return normalizedRequested.every((market)=>normalizedCached.includes(market));\n}\n/**\n * Get cached data for markets, supporting partial matches\n *\n * @param sport The sport key\n * @param eventId Optional event ID\n * @param markets The markets being requested\n * @returns Cached data if available, null otherwise\n */ async function getMarketsCachedData(sport, eventId, markets) {\n    // Try exact match first\n    const exactKey = generateOddsCacheKey({\n        sport,\n        eventId,\n        market: markets\n    });\n    const exactMatch = await getCachedData(exactKey);\n    if (exactMatch) {\n        return exactMatch;\n    }\n    // If no exact match, check for superset cache keys\n    // This is a simplified approach - in production you might want to\n    // maintain a registry of active cache keys for more efficient lookup\n    // For now, we'll just check a few common combinations\n    const commonCombinations = [\n        // Standard + alternate pairs\n        [\n            ...markets,\n            ...markets.map((m)=>`${m}_alternate`)\n        ],\n        // Just the base markets (for when alternates were requested but we have base)\n        normalizeMarkets(markets)\n    ];\n    for (const combo of commonCombinations){\n        const comboKey = generateOddsCacheKey({\n            sport,\n            eventId,\n            market: combo\n        });\n        const comboMatch = await getCachedData(comboKey);\n        if (comboMatch) {\n            return comboMatch;\n        }\n    }\n    return null;\n}\n// Get cached odds data\nasync function getCachedOdds(key) {\n    try {\n        const data = await redis.get(key);\n        return data;\n    } catch (error) {\n        console.error(\"Redis get error:\", error);\n        return null;\n    }\n}\n// Set odds data in cache\nasync function setCachedOdds(key, data) {\n    try {\n        const cacheData = {\n            lastUpdated: new Date().toISOString(),\n            data\n        };\n        await redis.set(key, cacheData, {\n            ex: CACHE_TTL\n        });\n    } catch (error) {\n        console.error(\"Redis set error:\", error);\n    }\n}\nasync function getCachedData(key) {\n    try {\n        const data = await redis.get(key);\n        return data;\n    } catch (error) {\n        console.error(\"Redis get error:\", error);\n        return null;\n    }\n}\nasync function setCachedData(key, data, ttl = CACHE_TTL) {\n    try {\n        await redis.set(key, data, {\n            ex: ttl\n        });\n    } catch (error) {\n        console.error(\"Redis set error:\", error);\n    }\n}\nasync function invalidateCache(key) {\n    try {\n        await redis.del(key);\n    } catch (error) {\n        console.error(\"Redis delete error:\", error);\n    }\n}\n// Helper to generate consistent cache keys\nfunction generateCacheKey(parts) {\n    return parts.join(\":\");\n}\n/**\n * Filters cached odds data to include only the specified sportsbooks\n *\n * @param data The complete cached data with all sportsbooks\n * @param selectedSportsbooks Array of sportsbook IDs to include\n * @returns Filtered data with only the selected sportsbooks\n */ function filterCachedOddsBySelectedSportsbooks(data, selectedSportsbooks) {\n    if (!data) return data;\n    // Handle array of events/games\n    if (Array.isArray(data)) {\n        return data.map((item)=>filterSingleItemBookmakers(item, selectedSportsbooks));\n    }\n    // Handle single event/game\n    return filterSingleItemBookmakers(data, selectedSportsbooks);\n}\n/**\n * Helper function to filter bookmakers for a single item\n */ function filterSingleItemBookmakers(item, selectedSportsbooks) {\n    if (!item.bookmakers || !Array.isArray(item.bookmakers)) {\n        return item;\n    }\n    // Create a shallow copy of the item\n    const filteredItem = {\n        ...item\n    };\n    // Filter bookmakers to only include selected ones\n    filteredItem.bookmakers = item.bookmakers.filter((bookmaker)=>selectedSportsbooks.includes(bookmaker.key));\n    return filteredItem;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxTQUFTb0Msc0NBRWRqQixJQUFhLEVBQUVrQixtQkFBNkI7SUFDNUMsSUFBSSxDQUFDbEIsTUFBTSxPQUFPQTtJQUVsQiwrQkFBK0I7SUFDL0IsSUFBSTNCLE1BQU04QyxPQUFPLENBQUNuQixPQUFPO1FBQ3ZCLE9BQU9BLEtBQUtOLEdBQUcsQ0FBQyxDQUFDMEIsT0FDZkMsMkJBQTJCRCxNQUFNRjtJQUVyQztJQUVBLDJCQUEyQjtJQUMzQixPQUFPRywyQkFBMkJyQixNQUFNa0I7QUFDMUM7QUFFQTs7Q0FFQyxHQUNELFNBQVNHLDJCQUNQRCxJQUFPLEVBQ1BGLG1CQUE2QjtJQUU3QixJQUFJLENBQUNFLEtBQUtFLFVBQVUsSUFBSSxDQUFDakQsTUFBTThDLE9BQU8sQ0FBQ0MsS0FBS0UsVUFBVSxHQUFHO1FBQ3ZELE9BQU9GO0lBQ1Q7SUFFQSxvQ0FBb0M7SUFDcEMsTUFBTUcsZUFBZTtRQUFFLEdBQUdILElBQUk7SUFBQztJQUUvQixrREFBa0Q7SUFDbERHLGFBQWFELFVBQVUsR0FBR0YsS0FBS0UsVUFBVSxDQUFDRSxNQUFNLENBQUMsQ0FBQ0MsWUFDaERQLG9CQUFvQjlCLFFBQVEsQ0FBQ3FDLFVBQVU5QyxHQUFHO0lBRzVDLE9BQU80QztBQUNUIiwic291cmNlcyI6WyIvVXNlcnMvZHJld21hc2Nob2ZmL2Rldi91bmp1aWNlZC9hcHBzL3dlYi9saWIvcmVkaXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVkaXMgfSBmcm9tIFwiQHVwc3Rhc2gvcmVkaXNcIjtcblxuLy8gSW5pdGlhbGl6ZSBSZWRpcyBjbGllbnRcbmV4cG9ydCBjb25zdCByZWRpcyA9IG5ldyBSZWRpcyh7XG4gIHVybDogcHJvY2Vzcy5lbnYuVVBTVEFTSF9SRURJU19SRVNUX1VSTCEsXG4gIHRva2VuOiBwcm9jZXNzLmVudi5VUFNUQVNIX1JFRElTX1JFU1RfVE9LRU4hLFxufSk7XG5cbi8vIENhY2hlIFRUTCBpbiBzZWNvbmRzICgyMCBtaW51dGVzKVxuZXhwb3J0IGNvbnN0IENBQ0hFX1RUTCA9IDEyMDA7XG5cbi8vIFR5cGUgZm9yIGNhY2hlZCBvZGRzIGRhdGFcbmV4cG9ydCBpbnRlcmZhY2UgQ2FjaGVkT2Rkc0RhdGEge1xuICBsYXN0VXBkYXRlZDogc3RyaW5nO1xuICBkYXRhOiBhbnk7IC8vIFJlcGxhY2Ugd2l0aCB5b3VyIG9kZHMgZGF0YSB0eXBlXG59XG5cbmludGVyZmFjZSBDYWNoZWRIaXRSYXRlRGF0YSB7XG4gIGhpdFJhdGVQcm9maWxlOiBhbnk7XG4gIHByb3BzT2Rkcz86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIGZhbGxiYWNrX29kZHM/OiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCB7XG4gICAgcHJpY2U6IG51bWJlcjtcbiAgICBsaW5rPzogc3RyaW5nO1xuICAgIHNpZD86IHN0cmluZztcbiAgfT4+O1xuICBsYXN0VXBkYXRlZDogc3RyaW5nO1xufVxuXG4vKipcbiAqIE5vcm1hbGl6ZSBtYXJrZXQgbmFtZXMgZm9yIGNvbnNpc3RlbnQgY2FjaGUga2V5c1xuICogVGhpcyBlbnN1cmVzIHRoYXQgXCJiYXR0ZXJfaGl0c1wiIGFuZCBcImJhdHRlcl9oaXRzLGJhdHRlcl9oaXRzX2FsdGVybmF0ZVwiXG4gKiBjYW4gc2hhcmUgdGhlIHNhbWUgY2FjaGVkIGRhdGFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZU1hcmtldHMobWFya2V0czogc3RyaW5nIHwgc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gIC8vIENvbnZlcnQgdG8gYXJyYXkgaWYgaXQncyBhIHN0cmluZ1xuICBjb25zdCBtYXJrZXRBcnJheSA9XG4gICAgdHlwZW9mIG1hcmtldHMgPT09IFwic3RyaW5nXCIgPyBtYXJrZXRzLnNwbGl0KFwiLFwiKSA6IG1hcmtldHM7XG5cbiAgLy8gQ3JlYXRlIGEgc2V0IG9mIGJhc2UgbWFya2V0cyAod2l0aG91dCBfYWx0ZXJuYXRlIHN1ZmZpeClcbiAgY29uc3QgYmFzZU1hcmtldHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3QgYWx0ZXJuYXRlTWFya2V0cyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG4gIG1hcmtldEFycmF5LmZvckVhY2goKG1hcmtldCkgPT4ge1xuICAgIGlmIChtYXJrZXQuZW5kc1dpdGgoXCJfYWx0ZXJuYXRlXCIpKSB7XG4gICAgICBjb25zdCBiYXNlTWFya2V0ID0gbWFya2V0LnJlcGxhY2UoXCJfYWx0ZXJuYXRlXCIsIFwiXCIpO1xuICAgICAgYWx0ZXJuYXRlTWFya2V0cy5hZGQoYmFzZU1hcmtldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJhc2VNYXJrZXRzLmFkZChtYXJrZXQpO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gU29ydCBmb3IgY29uc2lzdGVudCBvcmRlcmluZyBpbiBjYWNoZSBrZXlzXG4gIHJldHVybiBBcnJheS5mcm9tKGJhc2VNYXJrZXRzKS5zb3J0KCk7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgY2FjaGUga2V5IGZvciBvZGRzIGRhdGEgd2l0aCBub3JtYWxpemVkIG1hcmtldHNcbiAqXG4gKiBAcGFyYW0gcGFyYW1zIFBhcmFtZXRlcnMgdG8gZ2VuZXJhdGUgdGhlIGNhY2hlIGtleVxuICogQHJldHVybnMgQSBjYWNoZSBrZXkgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZU9kZHNDYWNoZUtleSh7XG4gIHNwb3J0LFxuICBldmVudElkLFxuICBtYXJrZXQsXG59OiB7XG4gIHNwb3J0OiBzdHJpbmc7XG4gIGV2ZW50SWQ/OiBzdHJpbmc7XG4gIG1hcmtldDogc3RyaW5nIHwgc3RyaW5nW107XG4gIGJvb2ttYWtlcnM/OiBzdHJpbmdbXTsgLy8gS2VwdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSBidXQgbm90IHVzZWRcbn0pOiBzdHJpbmcge1xuICAvLyBCdWlsZCB0aGUga2V5IHdpdGhvdXQgYm9va21ha2Vyc1xuICBsZXQga2V5ID0gYG9kZHM6JHtzcG9ydH1gO1xuXG4gIC8vIEFkZCBldmVudElkIGlmIHByb3ZpZGVkXG4gIGlmIChldmVudElkKSB7XG4gICAga2V5ICs9IGA6JHtldmVudElkfWA7XG4gIH1cblxuICAvLyBOb3JtYWxpemUgYW5kIGFkZCBtYXJrZXRzXG4gIGNvbnN0IG5vcm1hbGl6ZWRNYXJrZXRzID0gbm9ybWFsaXplTWFya2V0cyhtYXJrZXQpO1xuICBrZXkgKz0gYDoke25vcm1hbGl6ZWRNYXJrZXRzLmpvaW4oXCJfXCIpfWA7XG5cbiAgcmV0dXJuIGtleTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB3ZSBoYXZlIGEgc3VwZXJzZXQgb2YgdGhlIHJlcXVlc3RlZCBtYXJrZXRzIGluIGNhY2hlXG4gKlxuICogQHBhcmFtIHJlcXVlc3RlZE1hcmtldHMgVGhlIG1hcmtldHMgYmVpbmcgcmVxdWVzdGVkXG4gKiBAcGFyYW0gY2FjaGVkTWFya2V0cyBUaGUgbWFya2V0cyB3ZSBoYXZlIGluIGNhY2hlXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBjYWNoZWQgbWFya2V0cyBjb250YWluIGFsbCByZXF1ZXN0ZWQgbWFya2V0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzQWxsUmVxdWVzdGVkTWFya2V0cyhcbiAgcmVxdWVzdGVkTWFya2V0czogc3RyaW5nW10sXG4gIGNhY2hlZE1hcmtldHM6IHN0cmluZ1tdXG4pOiBib29sZWFuIHtcbiAgLy8gTm9ybWFsaXplIGJvdGggc2V0cyBvZiBtYXJrZXRzXG4gIGNvbnN0IG5vcm1hbGl6ZWRSZXF1ZXN0ZWQgPSBub3JtYWxpemVNYXJrZXRzKHJlcXVlc3RlZE1hcmtldHMpO1xuICBjb25zdCBub3JtYWxpemVkQ2FjaGVkID0gbm9ybWFsaXplTWFya2V0cyhjYWNoZWRNYXJrZXRzKTtcblxuICAvLyBDaGVjayBpZiBhbGwgcmVxdWVzdGVkIG1hcmtldHMgYXJlIGluIHRoZSBjYWNoZWQgbWFya2V0c1xuICByZXR1cm4gbm9ybWFsaXplZFJlcXVlc3RlZC5ldmVyeSgobWFya2V0KSA9PlxuICAgIG5vcm1hbGl6ZWRDYWNoZWQuaW5jbHVkZXMobWFya2V0KVxuICApO1xufVxuXG4vKipcbiAqIEdldCBjYWNoZWQgZGF0YSBmb3IgbWFya2V0cywgc3VwcG9ydGluZyBwYXJ0aWFsIG1hdGNoZXNcbiAqXG4gKiBAcGFyYW0gc3BvcnQgVGhlIHNwb3J0IGtleVxuICogQHBhcmFtIGV2ZW50SWQgT3B0aW9uYWwgZXZlbnQgSURcbiAqIEBwYXJhbSBtYXJrZXRzIFRoZSBtYXJrZXRzIGJlaW5nIHJlcXVlc3RlZFxuICogQHJldHVybnMgQ2FjaGVkIGRhdGEgaWYgYXZhaWxhYmxlLCBudWxsIG90aGVyd2lzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWFya2V0c0NhY2hlZERhdGE8VD4oXG4gIHNwb3J0OiBzdHJpbmcsXG4gIGV2ZW50SWQ6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgbWFya2V0czogc3RyaW5nW11cbik6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgLy8gVHJ5IGV4YWN0IG1hdGNoIGZpcnN0XG4gIGNvbnN0IGV4YWN0S2V5ID0gZ2VuZXJhdGVPZGRzQ2FjaGVLZXkoe1xuICAgIHNwb3J0LFxuICAgIGV2ZW50SWQsXG4gICAgbWFya2V0OiBtYXJrZXRzLFxuICB9KTtcblxuICBjb25zdCBleGFjdE1hdGNoID0gYXdhaXQgZ2V0Q2FjaGVkRGF0YTxUPihleGFjdEtleSk7XG4gIGlmIChleGFjdE1hdGNoKSB7XG4gICAgcmV0dXJuIGV4YWN0TWF0Y2g7XG4gIH1cblxuICAvLyBJZiBubyBleGFjdCBtYXRjaCwgY2hlY2sgZm9yIHN1cGVyc2V0IGNhY2hlIGtleXNcbiAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgYXBwcm9hY2ggLSBpbiBwcm9kdWN0aW9uIHlvdSBtaWdodCB3YW50IHRvXG4gIC8vIG1haW50YWluIGEgcmVnaXN0cnkgb2YgYWN0aXZlIGNhY2hlIGtleXMgZm9yIG1vcmUgZWZmaWNpZW50IGxvb2t1cFxuXG4gIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgY2hlY2sgYSBmZXcgY29tbW9uIGNvbWJpbmF0aW9uc1xuICBjb25zdCBjb21tb25Db21iaW5hdGlvbnMgPSBbXG4gICAgLy8gU3RhbmRhcmQgKyBhbHRlcm5hdGUgcGFpcnNcbiAgICBbLi4ubWFya2V0cywgLi4ubWFya2V0cy5tYXAoKG0pID0+IGAke219X2FsdGVybmF0ZWApXSxcbiAgICAvLyBKdXN0IHRoZSBiYXNlIG1hcmtldHMgKGZvciB3aGVuIGFsdGVybmF0ZXMgd2VyZSByZXF1ZXN0ZWQgYnV0IHdlIGhhdmUgYmFzZSlcbiAgICBub3JtYWxpemVNYXJrZXRzKG1hcmtldHMpLFxuICBdO1xuXG4gIGZvciAoY29uc3QgY29tYm8gb2YgY29tbW9uQ29tYmluYXRpb25zKSB7XG4gICAgY29uc3QgY29tYm9LZXkgPSBnZW5lcmF0ZU9kZHNDYWNoZUtleSh7XG4gICAgICBzcG9ydCxcbiAgICAgIGV2ZW50SWQsXG4gICAgICBtYXJrZXQ6IGNvbWJvLFxuICAgIH0pO1xuXG4gICAgY29uc3QgY29tYm9NYXRjaCA9IGF3YWl0IGdldENhY2hlZERhdGE8VD4oY29tYm9LZXkpO1xuICAgIGlmIChjb21ib01hdGNoKSB7XG4gICAgICByZXR1cm4gY29tYm9NYXRjaDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuLy8gR2V0IGNhY2hlZCBvZGRzIGRhdGFcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYWNoZWRPZGRzKFxuICBrZXk6IHN0cmluZ1xuKTogUHJvbWlzZTxDYWNoZWRPZGRzRGF0YSB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVkaXMuZ2V0PENhY2hlZE9kZHNEYXRhPihrZXkpO1xuICAgIHJldHVybiBkYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJSZWRpcyBnZXQgZXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBTZXQgb2RkcyBkYXRhIGluIGNhY2hlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0Q2FjaGVkT2RkcyhrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2FjaGVEYXRhOiBDYWNoZWRPZGRzRGF0YSA9IHtcbiAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBkYXRhLFxuICAgIH07XG4gICAgYXdhaXQgcmVkaXMuc2V0KGtleSwgY2FjaGVEYXRhLCB7IGV4OiBDQUNIRV9UVEwgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlJlZGlzIHNldCBlcnJvcjpcIiwgZXJyb3IpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYWNoZWREYXRhPFQ+KGtleTogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZWRpcy5nZXQ8VD4oa2V5KTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiUmVkaXMgZ2V0IGVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENhY2hlZERhdGE8VD4oXG4gIGtleTogc3RyaW5nLFxuICBkYXRhOiBULFxuICB0dGw6IG51bWJlciA9IENBQ0hFX1RUTFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgcmVkaXMuc2V0KGtleSwgZGF0YSwgeyBleDogdHRsIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJSZWRpcyBzZXQgZXJyb3I6XCIsIGVycm9yKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW52YWxpZGF0ZUNhY2hlKGtleTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgcmVkaXMuZGVsKGtleSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlJlZGlzIGRlbGV0ZSBlcnJvcjpcIiwgZXJyb3IpO1xuICB9XG59XG5cbi8vIEhlbHBlciB0byBnZW5lcmF0ZSBjb25zaXN0ZW50IGNhY2hlIGtleXNcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUNhY2hlS2V5KHBhcnRzOiBzdHJpbmdbXSk6IHN0cmluZyB7XG4gIHJldHVybiBwYXJ0cy5qb2luKFwiOlwiKTtcbn1cblxuLyoqXG4gKiBGaWx0ZXJzIGNhY2hlZCBvZGRzIGRhdGEgdG8gaW5jbHVkZSBvbmx5IHRoZSBzcGVjaWZpZWQgc3BvcnRzYm9va3NcbiAqXG4gKiBAcGFyYW0gZGF0YSBUaGUgY29tcGxldGUgY2FjaGVkIGRhdGEgd2l0aCBhbGwgc3BvcnRzYm9va3NcbiAqIEBwYXJhbSBzZWxlY3RlZFNwb3J0c2Jvb2tzIEFycmF5IG9mIHNwb3J0c2Jvb2sgSURzIHRvIGluY2x1ZGVcbiAqIEByZXR1cm5zIEZpbHRlcmVkIGRhdGEgd2l0aCBvbmx5IHRoZSBzZWxlY3RlZCBzcG9ydHNib29rc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyQ2FjaGVkT2Rkc0J5U2VsZWN0ZWRTcG9ydHNib29rczxcbiAgVCBleHRlbmRzIHsgYm9va21ha2Vycz86IGFueVtdIH1cbj4oZGF0YTogVCB8IFRbXSwgc2VsZWN0ZWRTcG9ydHNib29rczogc3RyaW5nW10pOiBUIHwgVFtdIHtcbiAgaWYgKCFkYXRhKSByZXR1cm4gZGF0YTtcblxuICAvLyBIYW5kbGUgYXJyYXkgb2YgZXZlbnRzL2dhbWVzXG4gIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgcmV0dXJuIGRhdGEubWFwKChpdGVtKSA9PlxuICAgICAgZmlsdGVyU2luZ2xlSXRlbUJvb2ttYWtlcnMoaXRlbSwgc2VsZWN0ZWRTcG9ydHNib29rcylcbiAgICApO1xuICB9XG5cbiAgLy8gSGFuZGxlIHNpbmdsZSBldmVudC9nYW1lXG4gIHJldHVybiBmaWx0ZXJTaW5nbGVJdGVtQm9va21ha2VycyhkYXRhLCBzZWxlY3RlZFNwb3J0c2Jvb2tzKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gZmlsdGVyIGJvb2ttYWtlcnMgZm9yIGEgc2luZ2xlIGl0ZW1cbiAqL1xuZnVuY3Rpb24gZmlsdGVyU2luZ2xlSXRlbUJvb2ttYWtlcnM8VCBleHRlbmRzIHsgYm9va21ha2Vycz86IGFueVtdIH0+KFxuICBpdGVtOiBULFxuICBzZWxlY3RlZFNwb3J0c2Jvb2tzOiBzdHJpbmdbXVxuKTogVCB7XG4gIGlmICghaXRlbS5ib29rbWFrZXJzIHx8ICFBcnJheS5pc0FycmF5KGl0ZW0uYm9va21ha2VycykpIHtcbiAgICByZXR1cm4gaXRlbTtcbiAgfVxuXG4gIC8vIENyZWF0ZSBhIHNoYWxsb3cgY29weSBvZiB0aGUgaXRlbVxuICBjb25zdCBmaWx0ZXJlZEl0ZW0gPSB7IC4uLml0ZW0gfTtcblxuICAvLyBGaWx0ZXIgYm9va21ha2VycyB0byBvbmx5IGluY2x1ZGUgc2VsZWN0ZWQgb25lc1xuICBmaWx0ZXJlZEl0ZW0uYm9va21ha2VycyA9IGl0ZW0uYm9va21ha2Vycy5maWx0ZXIoKGJvb2ttYWtlcikgPT5cbiAgICBzZWxlY3RlZFNwb3J0c2Jvb2tzLmluY2x1ZGVzKGJvb2ttYWtlci5rZXkpXG4gICk7XG5cbiAgcmV0dXJuIGZpbHRlcmVkSXRlbTtcbn1cblxuXG5cbiJdLCJuYW1lcyI6WyJSZWRpcyIsInJlZGlzIiwidXJsIiwicHJvY2VzcyIsImVudiIsIlVQU1RBU0hfUkVESVNfUkVTVF9VUkwiLCJ0b2tlbiIsIlVQU1RBU0hfUkVESVNfUkVTVF9UT0tFTiIsIkNBQ0hFX1RUTCIsIm5vcm1hbGl6ZU1hcmtldHMiLCJtYXJrZXRzIiwibWFya2V0QXJyYXkiLCJzcGxpdCIsImJhc2VNYXJrZXRzIiwiU2V0IiwiYWx0ZXJuYXRlTWFya2V0cyIsImZvckVhY2giLCJtYXJrZXQiLCJlbmRzV2l0aCIsImJhc2VNYXJrZXQiLCJyZXBsYWNlIiwiYWRkIiwiQXJyYXkiLCJmcm9tIiwic29ydCIsImdlbmVyYXRlT2Rkc0NhY2hlS2V5Iiwic3BvcnQiLCJldmVudElkIiwia2V5Iiwibm9ybWFsaXplZE1hcmtldHMiLCJqb2luIiwiaGFzQWxsUmVxdWVzdGVkTWFya2V0cyIsInJlcXVlc3RlZE1hcmtldHMiLCJjYWNoZWRNYXJrZXRzIiwibm9ybWFsaXplZFJlcXVlc3RlZCIsIm5vcm1hbGl6ZWRDYWNoZWQiLCJldmVyeSIsImluY2x1ZGVzIiwiZ2V0TWFya2V0c0NhY2hlZERhdGEiLCJleGFjdEtleSIsImV4YWN0TWF0Y2giLCJnZXRDYWNoZWREYXRhIiwiY29tbW9uQ29tYmluYXRpb25zIiwibWFwIiwibSIsImNvbWJvIiwiY29tYm9LZXkiLCJjb21ib01hdGNoIiwiZ2V0Q2FjaGVkT2RkcyIsImRhdGEiLCJnZXQiLCJlcnJvciIsImNvbnNvbGUiLCJzZXRDYWNoZWRPZGRzIiwiY2FjaGVEYXRhIiwibGFzdFVwZGF0ZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzZXQiLCJleCIsInNldENhY2hlZERhdGEiLCJ0dGwiLCJpbnZhbGlkYXRlQ2FjaGUiLCJkZWwiLCJnZW5lcmF0ZUNhY2hlS2V5IiwicGFydHMiLCJmaWx0ZXJDYWNoZWRPZGRzQnlTZWxlY3RlZFNwb3J0c2Jvb2tzIiwic2VsZWN0ZWRTcG9ydHNib29rcyIsImlzQXJyYXkiLCJpdGVtIiwiZmlsdGVyU2luZ2xlSXRlbUJvb2ttYWtlcnMiLCJib29rbWFrZXJzIiwiZmlsdGVyZWRJdGVtIiwiZmlsdGVyIiwiYm9va21ha2VyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/redis.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/../../node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n/**\n * Create a Supabase client for server-side API routes\n * Uses service role key for elevated permissions (bypasses RLS)\n */ function createServerSupabaseClient() {\n    const supabaseUrl = \"https://mcnbnrpaqretktdiglqd.supabase.co\";\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!supabaseUrl || !supabaseServiceKey) {\n        throw new Error('Missing Supabase environment variables');\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXFEO0FBRXJEOzs7Q0FHQyxHQUNNLFNBQVNDO0lBQ2QsTUFBTUMsY0FBY0MsMENBQW9DO0lBQ3hELE1BQU1HLHFCQUFxQkgsUUFBUUMsR0FBRyxDQUFDRyx5QkFBeUI7SUFFaEUsSUFBSSxDQUFDTCxlQUFlLENBQUNJLG9CQUFvQjtRQUN2QyxNQUFNLElBQUlFLE1BQU07SUFDbEI7SUFFQSxPQUFPUixtRUFBWUEsQ0FBQ0UsYUFBYUksb0JBQW9CO1FBQ25ERyxNQUFNO1lBQ0pDLGtCQUFrQjtZQUNsQkMsZ0JBQWdCO1FBQ2xCO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2RyZXdtYXNjaG9mZi9kZXYvdW5qdWljZWQvYXBwcy93ZWIvbGliL3N1cGFiYXNlLXNlcnZlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuXG4vKipcbiAqIENyZWF0ZSBhIFN1cGFiYXNlIGNsaWVudCBmb3Igc2VydmVyLXNpZGUgQVBJIHJvdXRlc1xuICogVXNlcyBzZXJ2aWNlIHJvbGUga2V5IGZvciBlbGV2YXRlZCBwZXJtaXNzaW9ucyAoYnlwYXNzZXMgUkxTKVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQoKSB7XG4gIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuICBjb25zdCBzdXBhYmFzZVNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xuXG4gIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlU2VydmljZUtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKTtcbiAgfVxuXG4gIHJldHVybiBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSwge1xuICAgIGF1dGg6IHtcbiAgICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxuICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLFxuICAgIH0sXG4gIH0pO1xufVxuXG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwiY3JlYXRlU2VydmVyU3VwYWJhc2VDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZVNlcnZpY2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiRXJyb3IiLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ }),

/***/ "(ssr)/../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "module":
/*!*************************!*\
  !*** external "module" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("module");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/@upstash","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/uncrypto","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&page=%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fnba%2Fhit-rates%2Fv2%2Froute.ts&appDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdrewmaschoff%2Fdev%2Funjuiced%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();